<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>SE-0126 Refactor Metatypes, repurpose `T.self` and `Mirror` - Swift Evolution List</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>SE-0126 Refactor Metatypes, repurpose T.self and Mirror | Swift Evolution List</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="SE-0126 Refactor Metatypes, repurpose T.self and Mirror" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Yuhuu!" /> <meta property="og:description" content="Yuhuu!" /> <link rel="canonical" href="http://localhost:4000/docs/2019-08-26-0126-refactor-metatypes-repurpose-t-dot-self-and-mirror.html" /> <meta property="og:url" content="http://localhost:4000/docs/2019-08-26-0126-refactor-metatypes-repurpose-t-dot-self-and-mirror.html" /> <meta property="og:site_name" content="Swift Evolution List" /> <script type="application/ld+json"> {"url":"http://localhost:4000/docs/2019-08-26-0126-refactor-metatypes-repurpose-t-dot-self-and-mirror.html","headline":"SE-0126 Refactor Metatypes, repurpose T.self and Mirror","description":"Yuhuu!","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight">Swift Evolution List</a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item active"><a href="http://localhost:4000/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item active"><a href="http://localhost:4000/" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/about/" class="navigation-list-link">About</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0001-keywords-as-argument-labels.html" class="navigation-list-link">SE-0001 Allow (most) keywords as argument labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0002-remove-currying.html" class="navigation-list-link">SE-0002 Removing currying `func` declaration syntax</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0003-remove-var-parameters.html" class="navigation-list-link">SE-0003 Removing `var` from Function Parameters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0004-remove-pre-post-inc-decrement.html" class="navigation-list-link">SE-0004 Remove the `++` and `--` operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0005-objective-c-name-translation.html" class="navigation-list-link">SE-0005 Better Translation of Objective-C APIs Into Swift</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0006-apply-api-guidelines-to-the-standard-library.html" class="navigation-list-link">SE-0006 Apply API Guidelines to the Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0007-remove-c-style-for-loops.html" class="navigation-list-link">SE-0007 Remove C-style for-loops with conditions and incrementers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0008-lazy-flatmap-for-optionals.html" class="navigation-list-link">SE-0008 Add a Lazy flatMap for Sequences of Optionals #</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0009-require-self-for-accessing-instance-members.html" class="navigation-list-link">SE-0009 Require self for accessing instance members</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0010-add-staticstring-unicodescalarview.html" class="navigation-list-link">SE-0010 Add StaticString.UnicodeScalarView</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0011-replace-typealias-associated.html" class="navigation-list-link">SE-0011 Replace `typealias` keyword with `associatedtype` for associated type declarations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0012-add-noescape-to-public-library-api.html" class="navigation-list-link">SE-0012 Add `@noescape` to public library API</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0013-remove-partial-application-super.html" class="navigation-list-link">SE-0013 Remove Partial Application of Non-Final Super Methods (Swift 2.2)</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0014-constrained-AnySequence.html" class="navigation-list-link">SE-0014 Constraining `AnySequence.init`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0015-tuple-comparison-operators.html" class="navigation-list-link">SE-0015 Tuple comparison operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0016-initializers-for-converting-unsafe-pointers-to-ints.html" class="navigation-list-link">SE-0016 Add initializers to Int and UInt to convert from UnsafePointer and UnsafeMutablePointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0017-convert-unmanaged-to-use-unsafepointer.html" class="navigation-list-link">SE-0017 Change `Unmanaged` to use `UnsafePointer`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0018-flexible-memberwise-initialization.html" class="navigation-list-link">SE-0018 Flexible Memberwise Initialization</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0019-package-manager-testing.html" class="navigation-list-link">SE-0019 Swift Testing</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0020-if-swift-version.html" class="navigation-list-link">SE-0020 Swift Language Version Build Configuration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0021-generalized-naming.html" class="navigation-list-link">SE-0021 Naming Functions with Argument Labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0022-objc-selectors.html" class="navigation-list-link">SE-0022 Referencing the Objective-C selector of a method</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0023-api-guidelines.html" class="navigation-list-link">SE-0023 API Design Guidelines</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0024-optional-value-setter.html" class="navigation-list-link">SE-0024 Optional Value Setter `??=`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0025-scoped-access-level.html" class="navigation-list-link">SE-0025 Scoped Access Level</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0026-abstract-classes-and-methods.html" class="navigation-list-link">SE-0026 Abstract classes and methods</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0027-string-from-code-units.html" class="navigation-list-link">SE-0027 Expose code unit initializers on String</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0028-modernizing-debug-identifiers.html" class="navigation-list-link">SE-0028 Modernizing Swift's Debugging Identifiers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0029-remove-implicit-tuple-splat.html" class="navigation-list-link">SE-0029 Remove implicit tuple splat behavior from function applications</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0030-property-behavior-decls.html" class="navigation-list-link">SE-0030 Property Behaviors</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0031-adjusting-inout-declarations.html" class="navigation-list-link">SE-0031 Adjusting `inout` Declarations for Type Decoration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0032-sequencetype-find.html" class="navigation-list-link">SE-0032 Add `first(where:)` method to `Sequence`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0033-import-objc-constants.html" class="navigation-list-link">SE-0033 Import Objective-C Constants as Swift Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0034-disambiguating-line.html" class="navigation-list-link">SE-0034 Disambiguating Line Control Statements from Debugging Identifiers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0035-limit-inout-capture.html" class="navigation-list-link">SE-0035 Limiting `inout` capture to `@noescape` contexts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0036-enum-dot.html" class="navigation-list-link">SE-0036 Requiring Leading Dot Prefixes for Enum Instance Member Implementations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0037-clarify-comments-and-operators.html" class="navigation-list-link">SE-0037 Clarify interaction between comments & operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0038-swiftpm-c-language-targets.html" class="navigation-list-link">SE-0038 Package Manager C Language Target Support</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0039-playgroundliterals.html" class="navigation-list-link">SE-0039 Modernizing Playground Literals</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0040-attributecolons.html" class="navigation-list-link">SE-0040 Replacing Equal Signs with Colons For Attribute Arguments</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0041-conversion-protocol-conventions.html" class="navigation-list-link">SE-0041 Updating Protocol Naming Conventions for Conversions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0042-flatten-method-types.html" class="navigation-list-link">SE-0042 Flattening the function type of unapplied method references</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0043-declare-variables-in-case-labels-with-multiple-patterns.html" class="navigation-list-link">SE-0043 Declare variables in 'case' labels with multiple patterns </a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0044-import-as-member.html" class="navigation-list-link">SE-0044 Import as member</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0045-scan-takewhile-dropwhile.html" class="navigation-list-link">SE-0045 Add prefix(while:) and drop(while:) to the stdlib</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0046-first-label.html" class="navigation-list-link">SE-0046 Establish consistent label behavior across all parameters including first labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0047-nonvoid-warn.html" class="navigation-list-link">SE-0047 Defaulting non-Void functions so they warn on unused results</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0048-generic-typealias.html" class="navigation-list-link">SE-0048 Generic Type Aliases</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0049-noescape-autoclosure-type-attrs.html" class="navigation-list-link">SE-0049 Move @noescape and @autoclosure to be type attributes</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0050-floating-point-stride.html" class="navigation-list-link">SE-0050 Decoupling Floating Point Strides from Generic Implementations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0051-stride-semantics.html" class="navigation-list-link">SE-0051 Conventionalizing `stride` semantics</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0052-iterator-post-nil-guarantee.html" class="navigation-list-link">SE-0052 Change IteratorType post-nil guarantee</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0053-remove-let-from-function-parameters.html" class="navigation-list-link">SE-0053 Remove explicit use of `let` from Function Parameters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0054-abolish-iuo.html" class="navigation-list-link">SE-0054 Abolish `ImplicitlyUnwrappedOptional` type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0055-optional-unsafe-pointers.html" class="navigation-list-link">SE-0055 Make unsafe pointer nullability explicit using Optional</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0056-trailing-closures-in-guard.html" class="navigation-list-link">SE-0056 Allow trailing closures in `guard` conditions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0057-importing-objc-generics.html" class="navigation-list-link">SE-0057 Importing Objective-C Lightweight Generics</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0058-objectivecbridgeable.html" class="navigation-list-link">SE-0058 Allow Swift types to provide custom Objective-C representations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0059-updated-set-apis.html" class="navigation-list-link">SE-0059 Update API Naming Guidelines and Rewrite Set APIs Accordingly</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0060-defaulted-parameter-order.html" class="navigation-list-link">SE-0060 Enforcing order of defaulted parameters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0061-autoreleasepool-signature.html" class="navigation-list-link">SE-0061 Add Generic Result and Error Handling to autoreleasepool()</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0062-objc-keypaths.html" class="navigation-list-link">SE-0062 Referencing Objective-C key-paths</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0063-swiftpm-system-module-search-paths.html" class="navigation-list-link">SE-0063 SwiftPM System Module Search Paths</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0064-property-selectors.html" class="navigation-list-link">SE-0064 Referencing the Objective-C selector of property getters and setters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0065-collections-move-indices.html" class="navigation-list-link">SE-0065 A New Model for Collections and Indices</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0066-standardize-function-type-syntax.html" class="navigation-list-link">SE-0066 Standardize function type argument syntax to require parentheses</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0067-floating-point-protocols.html" class="navigation-list-link">SE-0067 Enhanced Floating Point Protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0068-universal-self.html" class="navigation-list-link">SE-0068 Expanding Swift `Self` to class members and value types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0069-swift-mutability-for-foundation.html" class="navigation-list-link">SE-0069 Mutability and Foundation Value Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0070-optional-requirements.html" class="navigation-list-link">SE-0070 Make Optional Requirements Objective-C-only</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0071-member-keywords.html" class="navigation-list-link">SE-0071 Allow (most) keywords in member references</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0072-eliminate-implicit-bridging-conversions.html" class="navigation-list-link">SE-0072 Fully eliminate implicit bridging conversions from Swift</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0073-noescape-once.html" class="navigation-list-link">SE-0073 Marking closures as executing exactly once</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0074-binary-search.html" class="navigation-list-link">SE-0074 Implementation of Binary Search functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0075-import-test.html" class="navigation-list-link">SE-0075 Adding a Build Configuration Import Test</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0076-copying-to-unsafe-mutable-pointer-with-unsafe-pointer-source.html" class="navigation-list-link">SE-0076 Add overrides taking an UnsafePointer source to non-destructive copying methods on UnsafeMutablePointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0077-operator-precedence.html" class="navigation-list-link">SE-0077 Improved operator declarations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0078-rotate-algorithm.html" class="navigation-list-link">SE-0078 Implement a rotate algorithm, equivalent to std::rotate() in C++</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0079-upgrade-self-from-weak-to-strong.html" class="navigation-list-link">SE-0079 Allow using optional binding to upgrade `self` from a weak to strong reference</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0080-failable-numeric-initializers.html" class="navigation-list-link">SE-0080 Failable Numeric Conversion Initializers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0081-move-where-expression.html" class="navigation-list-link">SE-0081 Move `where` clause to end of declaration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0082-swiftpm-package-edit.html" class="navigation-list-link">SE-0082 Package Manager Editable Packages</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0083-remove-bridging-from-dynamic-casts.html" class="navigation-list-link">SE-0083 Remove bridging conversion behavior from dynamic casts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0084-trailing-commas.html" class="navigation-list-link">SE-0084 Allow trailing commas in parameter lists and tuples</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0085-package-manager-command-name.html" class="navigation-list-link">SE-0085 Package Manager Command Names</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0086-drop-foundation-ns.html" class="navigation-list-link">SE-0086 Drop NS Prefix in Swift Foundation</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0087-lazy-attribute.html" class="navigation-list-link">SE-0087 Rename `lazy` to `@lazy`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0088-libdispatch-for-swift3.html" class="navigation-list-link">SE-0088 Modernize libdispatch for Swift 3 naming conventions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0089-rename-string-reflection-init.html" class="navigation-list-link">SE-0089 Renaming `String.init<T>(_: T)`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0090-remove-dot-self.html" class="navigation-list-link">SE-0090 Remove `.self` and freely allow type references in expressions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0091-improving-operators-in-protocols.html" class="navigation-list-link">SE-0091 Improving operator requirements in protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0092-typealiases-in-protocols.html" class="navigation-list-link">SE-0092 Typealiases in protocols and protocol extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0093-slice-base.html" class="navigation-list-link">SE-0093 Adding a public `base` property to slices</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0094-sequence-function.html" class="navigation-list-link">SE-0094 Add sequence(first:next:) and sequence(state:next:) to the stdlib</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0095-any-as-existential.html" class="navigation-list-link">SE-0095 Replace `protocol<P1,P2>` syntax with `P1 & P2` syntax</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0096-dynamictype.html" class="navigation-list-link">SE-0096 Converting `dynamicType` from a property to an operator</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0097-negative-attributes.html" class="navigation-list-link">SE-0097 Normalizing naming for "negative" attributes</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0098-didset-capitalization.html" class="navigation-list-link">SE-0098 Lowercase `didSet` and `willSet` for more consistent keyword casing</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0099-conditionclauses.html" class="navigation-list-link">SE-0099 Restructuring Condition Clauses</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0100-add-sequence-based-init-and-merge-to-dictionary.html" class="navigation-list-link">SE-0100 Add sequence-based initializers and merge methods to Dictionary</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0101-standardizing-sizeof-naming.html" class="navigation-list-link">SE-0101 Reconfiguring `sizeof` and related functions into a unified `MemoryLayout` struct</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0102-noreturn-bottom-type.html" class="navigation-list-link">SE-0102 Remove `@noreturn` attribute and introduce an empty `Never` type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0103-make-noescape-default.html" class="navigation-list-link">SE-0103 Make non-escaping closures the default</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0104-improved-integers.html" class="navigation-list-link">SE-0104 Protocol-oriented integers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0105-remove-where-from-forin-loops.html" class="navigation-list-link">SE-0105 Removing Where Clauses from For-In Loops</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0106-rename-osx-to-macos.html" class="navigation-list-link">SE-0106 Add a `macOS` Alias for the `OSX` Platform Configuration Test</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0107-unsaferawpointer.html" class="navigation-list-link">SE-0107 UnsafeRawPointer API</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0108-remove-assoctype-inference.html" class="navigation-list-link">SE-0108 Remove associated type inference</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0109-remove-boolean.html" class="navigation-list-link">SE-0109 Remove the `Boolean` protocol </a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0110-distingish-single-tuple-arg.html" class="navigation-list-link">SE-0110 Distinguish between single-tuple and multiple-argument function types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0111-remove-arg-label-type-significance.html" class="navigation-list-link">SE-0111 Remove type system significance of function argument labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0112-nserror-bridging.html" class="navigation-list-link">SE-0112 Improved NSError Bridging</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0113-rounding-functions-on-floatingpoint.html" class="navigation-list-link">SE-0113 Add integral rounding functions to FloatingPoint</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0114-buffer-naming.html" class="navigation-list-link">SE-0114 Updating Buffer "Value" Names to "Header" Names</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0115-literal-syntax-protocols.html" class="navigation-list-link">SE-0115 Rename Literal Syntax Protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0116-id-as-any.html" class="navigation-list-link">SE-0116 Import Objective-C `id` as Swift `Any` type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0117-non-public-subclassable-by-default.html" class="navigation-list-link">SE-0117 Allow distinguishing between public access and public overridability</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0118-closure-parameter-names-and-labels.html" class="navigation-list-link">SE-0118 Closure Parameter Names and Labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0119-extensions-access-modifiers.html" class="navigation-list-link">SE-0119 Remove access modifiers from extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0120-revise-partition-method.html" class="navigation-list-link">SE-0120 Revise `partition` Method Signature</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0121-remove-optional-comparison-operators.html" class="navigation-list-link">SE-0121 Remove `Optional` Comparison Operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0122-use-colons-for-subscript-type-declarations.html" class="navigation-list-link">SE-0122 Use colons for subscript declarations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0123-disallow-value-to-optional-coercion-in-operator-arguments.html" class="navigation-list-link">SE-0123 Disallow coercion to optionals in operator arguments</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0124-bitpattern-label-for-int-initializer-objectidentfier.html" class="navigation-list-link">SE-0124 `Int.init(ObjectIdentifier)` and `UInt.init(ObjectIdentifier)` should have a `bitPattern:` label</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0125-remove-nonobjectivecbase.html" class="navigation-list-link">SE-0125 Remove `NonObjectiveCBase` and `isUniquelyReferenced`</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/docs/2019-08-26-0126-refactor-metatypes-repurpose-t-dot-self-and-mirror.html" class="navigation-list-link active">SE-0126 Refactor Metatypes, repurpose `T.self` and `Mirror`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0127-cleaning-up-stdlib-ptr-buffer.html" class="navigation-list-link">SE-0127 Cleaning up stdlib Pointer and Buffer Routines</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0128-unicodescalar-failable-initializer.html" class="navigation-list-link">SE-0128 Change failable UnicodeScalar initializers to failable</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0129-package-manager-test-naming-conventions.html" class="navigation-list-link">SE-0129 Package Manager Test Naming Conventions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0130-string-initializers-cleanup.html" class="navigation-list-link">SE-0130 Replace repeating `Character` and `UnicodeScalar` forms of String.init</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0131-anyhashable.html" class="navigation-list-link">SE-0131 Add `AnyHashable` to the standard library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0132-sequence-end-ops.html" class="navigation-list-link">SE-0132 Rationalizing Sequence end-operation names</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0133-rename-flatten-to-joined.html" class="navigation-list-link">SE-0133 Rename `flatten()` to `joined()`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0134-rename-string-properties.html" class="navigation-list-link">SE-0134 Rename two UTF8-related properties on String</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0135-package-manager-support-for-differentiating-packages-by-swift-version.html" class="navigation-list-link">SE-0135 Package Manager Support for Differentiating Packages by Swift version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0136-memory-layout-of-values.html" class="navigation-list-link">SE-0136 Memory layout of values</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0137-avoiding-lock-in.html" class="navigation-list-link">SE-0137 Avoiding Lock-In to Legacy Protocol Designs</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0138-unsaferawbufferpointer.html" class="navigation-list-link">SE-0138 UnsafeRawBufferPointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0139-bridge-nsnumber-and-nsvalue.html" class="navigation-list-link">SE-0139 Bridge Numeric Types to `NSNumber` and Cocoa Structs to `NSValue`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0140-bridge-optional-to-nsnull.html" class="navigation-list-link">SE-0140 Warn when `Optional` converts to `Any`, and bridge `Optional` As Its Payload Or `NSNull`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0141-available-by-swift-version.html" class="navigation-list-link">SE-0141 Availability by Swift version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0142-associated-types-constraints.html" class="navigation-list-link">SE-0142 Permit where clauses to constrain associated types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0143-conditional-conformances.html" class="navigation-list-link">SE-0143 Conditional conformances</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0144-allow-single-dollar-sign-as-valid-identifier.html" class="navigation-list-link">SE-0144 Allow Single Dollar Sign as a Valid Identifier</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0145-package-manager-version-pinning.html" class="navigation-list-link">SE-0145 Package Manager Version Pinning</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0146-package-manager-product-definitions.html" class="navigation-list-link">SE-0146 Package Manager Product Definitions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0147-move-unsafe-initialize-from.html" class="navigation-list-link">SE-0147 Move UnsafeMutablePointer.initialize(from:) to UnsafeMutableBufferPointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0148-generic-subscripts.html" class="navigation-list-link">SE-0148 Generic Subscripts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0149-package-manager-top-of-tree.html" class="navigation-list-link">SE-0149 Package Manager Support for Top of Tree development</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0150-package-manager-branch-support.html" class="navigation-list-link">SE-0150 Package Manager Support for branches</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0151-package-manager-swift-language-compatibility-version.html" class="navigation-list-link">SE-0151 Package Manager Swift Language Compatibility Version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0152-package-manager-tools-version.html" class="navigation-list-link">SE-0152 Package Manager Tools Version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0153-compensate-for-the-inconsistency-of-nscopyings-behaviour.html" class="navigation-list-link">SE-0153 Compensate for the inconsistency of `@NSCopying`'s behaviour</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0154-dictionary-key-and-value-collections.html" class="navigation-list-link">SE-0154 Provide Custom Collections for Dictionary Keys and Values</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0155-normalize-enum-case-representation.html" class="navigation-list-link">SE-0155 Normalize Enum Case Representation</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0156-subclass-existentials.html" class="navigation-list-link">SE-0156 Class and Subtype existentials</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0157-recursive-protocol-constraints.html" class="navigation-list-link">SE-0157 Support recursive constraints on associated types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0158-package-manager-manifest-api-redesign.html" class="navigation-list-link">SE-0158 Package Manager Manifest API Redesign</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0159-fix-private-access-levels.html" class="navigation-list-link">SE-0159 Fix Private Access Levels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0160-objc-inference.html" class="navigation-list-link">SE-0160 Limiting `@objc` inference</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0161-key-paths.html" class="navigation-list-link">SE-0161 Smart KeyPaths: Better Key-Value Coding for Swift</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0162-package-manager-custom-target-layouts.html" class="navigation-list-link">SE-0162 Package Manager Custom Target Layouts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0163-string-revision-1.html" class="navigation-list-link">SE-0163 String Revision: Collection Conformance, C Interop, Transcoding</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0164-remove-final-support-in-protocol-extensions.html" class="navigation-list-link">SE-0164 Remove final support in protocol extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0165-dict.html" class="navigation-list-link">SE-0165 Dictionary & Set Enhancements</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0166-swift-archival-serialization.html" class="navigation-list-link">SE-0166 Swift Archival & Serialization</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0167-swift-encoders.html" class="navigation-list-link">SE-0167 Swift Encoders</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0168-multi-line-string-literals.html" class="navigation-list-link">SE-0168 Multi-Line String Literals</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0169-improve-interaction-between-private-declarations-and-extensions.html" class="navigation-list-link">SE-0169 Improve Interaction Between `private` Declarations and Extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0170-nsnumber_bridge.html" class="navigation-list-link">SE-0170 NSNumber bridging and Numeric types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0171-reduce-with-inout.html" class="navigation-list-link">SE-0171 Reduce with `inout`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0172-one-sided-ranges.html" class="navigation-list-link">SE-0172 One-sided Ranges</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0173-swap-indices.html" class="navigation-list-link">SE-0173 Add `MutableCollection.swapAt(_:_:)`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0174-filter-range-replaceable.html" class="navigation-list-link">SE-0174 Change `filter` to return an associated type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0175-package-manager-revised-dependency-resolution.html" class="navigation-list-link">SE-0175 Package Manager Revised Dependency Resolution</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0176-enforce-exclusive-access-to-memory.html" class="navigation-list-link">SE-0176 Enforce Exclusive Access to Memory</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0177-add-clamped-to-method.html" class="navigation-list-link">SE-0177 Add clamp(to:) to the stdlib</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0178-character-unicode-view.html" class="navigation-list-link">SE-0178 Add `unicodeScalars` property to `Character`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0179-swift-run-command.html" class="navigation-list-link">SE-0179 Swift `run` Command</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0180-string-index-overhaul.html" class="navigation-list-link">SE-0180 String Index Overhaul</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0181-package-manager-cpp-language-version.html" class="navigation-list-link">SE-0181 Package Manager C/C++ Language Standard Support</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0182-newline-escape-in-strings.html" class="navigation-list-link">SE-0182 String Newline Escaping</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0183-substring-affordances.html" class="navigation-list-link">SE-0183 Substring performance affordances</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0184-unsafe-pointers-add-missing.html" class="navigation-list-link">SE-0184 Unsafe[Mutable][Raw][Buffer]Pointer: add missing methods, adjust existing labels for clarity, and remove deallocation size</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0185-synthesize-equatable-hashable.html" class="navigation-list-link">SE-0185 Synthesizing `Equatable` and `Hashable` conformance</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0186-remove-ownership-keyword-support-in-protocols.html" class="navigation-list-link">SE-0186 Remove ownership keyword support in protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0187-introduce-filtermap.html" class="navigation-list-link">SE-0187 Introduce Sequence.compactMap(_:)</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0188-stdlib-index-types-hashable.html" class="navigation-list-link">SE-0188 Make Standard Library Index Types Hashable</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0189-restrict-cross-module-struct-initializers.html" class="navigation-list-link">SE-0189 Restrict Cross-module Struct Initializers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0190-target-environment-platform-condition.html" class="navigation-list-link">SE-0190 Target environment platform condition</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0191-eliminate-indexdistance.html" class="navigation-list-link">SE-0191 Eliminate `IndexDistance` from `Collection`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0192-non-exhaustive-enums.html" class="navigation-list-link">SE-0192 Handling Future Enum Cases</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0193-cross-module-inlining-and-specialization.html" class="navigation-list-link">SE-0193 Cross-module inlining and specialization</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0194-derived-collection-of-enum-cases.html" class="navigation-list-link">SE-0194 Derived Collection of Enum Cases</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0195-dynamic-member-lookup.html" class="navigation-list-link">SE-0195 Introduce User-defined "Dynamic Member Lookup" Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0196-diagnostic-directives.html" class="navigation-list-link">SE-0196 Compiler Diagnostic Directives</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0197-remove-where.html" class="navigation-list-link">SE-0197 Adding in-place `removeAll(where:)` to the Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0198-playground-quicklook-api-revamp.html" class="navigation-list-link">SE-0198 Playground QuickLook API Revamp #</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0199-bool-toggle.html" class="navigation-list-link">SE-0199 Adding `toggle` to `Bool`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0200-raw-string-escaping.html" class="navigation-list-link">SE-0200 Enhancing String Literals Delimiters to Support Raw Text</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0201-package-manager-local-dependencies.html" class="navigation-list-link">SE-0201 Package Manager Local Dependencies</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0202-random-unification.html" class="navigation-list-link">SE-0202 Random Unification</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0203-rename-sequence-elements-equal.html" class="navigation-list-link">SE-0203 Rename Sequence.elementsEqual</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0204-add-last-methods.html" class="navigation-list-link">SE-0204 Add `last(where:)` and `lastIndex(where:)` Methods</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0205-withUnsafePointer-for-lets.html" class="navigation-list-link">SE-0205 `withUnsafePointer(to:_:)` and `withUnsafeBytes(of:_:)` for immutable values</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0206-hashable-enhancements.html" class="navigation-list-link">SE-0206 Hashable Enhancements</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0207-containsOnly.html" class="navigation-list-link">SE-0207 Add an `allSatisfy` algorithm to `Sequence`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0208-package-manager-system-library-targets.html" class="navigation-list-link">SE-0208 Package Manager System Library Targets</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0209-package-manager-swift-lang-version-update.html" class="navigation-list-link">SE-0209 Package Manager Swift Language Version API Update</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0210-key-path-offset.html" class="navigation-list-link">SE-0210 Add an `offset(of:)` method to `MemoryLayout`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0211-unicode-scalar-properties.html" class="navigation-list-link">SE-0211 Add Unicode Properties to `Unicode.Scalar`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0212-compiler-version-directive.html" class="navigation-list-link">SE-0212 Compiler Version Directive</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0213-literal-init-via-coercion.html" class="navigation-list-link">SE-0213 Literal initialization via coercion</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0214-DictionaryLiteral.html" class="navigation-list-link">SE-0214 Renaming the `DictionaryLiteral` type to `KeyValuePairs`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0215-conform-never-to-hashable-and-equatable.html" class="navigation-list-link">SE-0215 Conform `Never` to `Equatable` and `Hashable`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0216-dynamic-callable.html" class="navigation-list-link">SE-0216 Introduce user-defined dynamically "callable" types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0217-bangbang.html" class="navigation-list-link">SE-0217 Introducing the `!!` "Unwrap or Die" operator to the Swift Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0218-introduce-compact-map-values.html" class="navigation-list-link">SE-0218 Introduce `compactMapValues` to Dictionary</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0219-package-manager-dependency-mirroring.html" class="navigation-list-link">SE-0219 Package Manager Dependency Mirroring</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0220-count-where.html" class="navigation-list-link">SE-0220 `count(where:)`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0221-character-properties.html" class="navigation-list-link">SE-0221 Character Properties</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0222-lazy-compactmap-sequence.html" class="navigation-list-link">SE-0222 Lazy CompactMap Sequence</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0223-array-uninitialized-initializer.html" class="navigation-list-link">SE-0223 Accessing an Array's Uninitialized Buffer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0224-ifswift-lessthan-operator.html" class="navigation-list-link">SE-0224 Support 'less than' operator in compilation conditions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0225-binaryinteger-iseven-isodd-ismultiple.html" class="navigation-list-link">SE-0225 Adding `isMultiple` to `BinaryInteger`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0226-package-manager-target-based-dep-resolution.html" class="navigation-list-link">SE-0226 Package Manager Target Based Dependency Resolution</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0227-identity-keypath.html" class="navigation-list-link">SE-0227 Identity key path</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0228-fix-expressiblebystringinterpolation.html" class="navigation-list-link">SE-0228 Fix `ExpressibleByStringInterpolation`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0229-simd.html" class="navigation-list-link">SE-0229 SIMD Vectors</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0230-flatten-optional-try.html" class="navigation-list-link">SE-0230 Flatten nested optionals resulting from 'try?'</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0231-optional-iteration.html" class="navigation-list-link">SE-0231 Optional Iteration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0232-remove-customization-points.html" class="navigation-list-link">SE-0232 Remove Some Customization Points from the Standard Library's `Collection` Hierarchy</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0233-additive-arithmetic-protocol.html" class="navigation-list-link">SE-0233 Make `Numeric` Refine a new `AdditiveArithmetic` Protocol</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0234-remove-sequence-subsequence.html" class="navigation-list-link">SE-0234 Remove `Sequence.SubSequence`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0235-add-result.html" class="navigation-list-link">SE-0235 Add Result to the Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0236-package-manager-platform-deployment-settings.html" class="navigation-list-link">SE-0236 Package Manager Platform Deployment Settings</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0237-contiguous-collection.html" class="navigation-list-link">SE-0237 Introduce `withContiguous{Mutable}StorageIfAvailable` methods</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0238-package-manager-build-settings.html" class="navigation-list-link">SE-0238 Package Manager Target Specific Build Settings</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0239-codable-range.html" class="navigation-list-link">SE-0239 Add Codable conformance to Range types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0240-ordered-collection-diffing.html" class="navigation-list-link">SE-0240 Ordered Collection Diffing</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0241-string-index-explicit-encoding-offset.html" class="navigation-list-link">SE-0241 Deprecate String Index Encoded Offsets</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0242-default-values-memberwise.html" class="navigation-list-link">SE-0242 Synthesize default values for the memberwise initializer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0243-codepoint-and-character-literals.html" class="navigation-list-link">SE-0243 Integer-convertible character literals</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0244-opaque-result-types.html" class="navigation-list-link">SE-0244 Opaque Result Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0245-array-uninitialized-initializer.html" class="navigation-list-link">SE-0245 Add an Array Initializer with Access to Uninitialized Storage</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0246-mathable.html" class="navigation-list-link">SE-0246 Generic Math(s) Functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0247-contiguous-strings.html" class="navigation-list-link">SE-0247 Contiguous Strings</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0248-string-gaps-missing-apis.html" class="navigation-list-link">SE-0248 String Gaps and Missing APIs</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0249-key-path-literal-function-expressions.html" class="navigation-list-link">SE-0249 Key Path Expressions as Functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0250-swift-style-guide-and-formatter.html" class="navigation-list-link">SE-0250 Swift Code Style Guidelines and Formatter</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0251-simd-additions.html" class="navigation-list-link">SE-0251 SIMD additions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0252-keypath-dynamic-member-lookup.html" class="navigation-list-link">SE-0252 Key Path Member Lookup</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0253-callable.html" class="navigation-list-link">SE-0253 Introduce callables </a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0254-static-subscripts.html" class="navigation-list-link">SE-0254 Static and class subscripts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0255-omit-return.html" class="navigation-list-link">SE-0255 Implicit returns from single-expression functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0256-contiguous-collection.html" class="navigation-list-link">SE-0256 Introduce `{Mutable}ContiguousCollection` protocol</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0257-elide-comma.html" class="navigation-list-link">SE-0257 Eliding commas from multiline expression lists</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-xxxx-synthesize-computed-property.html" class="navigation-list-link"> Feature name</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Swift Evolution List" aria-label="Search Swift Evolution List" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="//github.com/pondok-programmer/swift-evolution-jekyll">Swift Evolution List</a></li> </ul> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 id="refactor-metatypes-repurpose-tself-and-mirror"> <a href="#refactor-metatypes-repurpose-tself-and-mirror" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Refactor Metatypes, repurpose <code class="highlighter-rouge">T.self</code> and <code class="highlighter-rouge">Mirror</code> </h1> <ul> <li>Proposal: <a href="0126-refactor-metatypes-repurpose-t-dot-self-and-mirror.md">SE-0126</a></li> <li>Authors: <a href="https://github.com/DevAndArtist">Adrian Zubarev</a>, <a href="https://github.com/Anton3">Anton Zhilin</a></li> <li>Review Manager: <a href="http://github.com/lattner">Chris Lattner</a></li> <li>Status: <strong>Withdrawn</strong></li> <li>Decision Notes: <a href="https://lists.swift.org/pipermail/swift-evolution-announce/2016-July/000251.html">Rationale</a></li> </ul> <h2 id="introduction"> <a href="#introduction" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Introduction </h2> <p>This proposal wants to revise metatypes <code class="highlighter-rouge">T.Type</code>, repurpose <em>public</em> <code class="highlighter-rouge">T.self</code> notation to return a new <code class="highlighter-rouge">Type&lt;T&gt;</code> type instance rather than a metatype, merge <strong>SE-0101</strong> into <code class="highlighter-rouge">Type&lt;T&gt;</code>, rename the global function from <strong>SE-0096</strong> to match the changes of this proposal and finally rename current <code class="highlighter-rouge">Mirror</code> type to introduce a new (lazy) <code class="highlighter-rouge">Mirror</code> type.</p> <p>Swift-evolution threads:</p> <ul> <li><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160718/024772.html">[Proposal] Refactor Metatypes, repurpose T[dot]self and Mirror</a></li> <li><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160704/023818.html">[Discussion] Seal <code class="highlighter-rouge">T.Type</code> into <code class="highlighter-rouge">Type&lt;T&gt;</code></a></li> <li><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160627/023067.html">[Discussion] Can we make <code class="highlighter-rouge">.Type</code> Hashable?</a></li> </ul> <p>GitHub Gist thread:</p> <ul> <li><a href="https://gist.github.com/Anton3/9931463695f1c3263333e18f04f9cd8e">Refactor metatypes</a></li> </ul> <h2 id="motivation"> <a href="#motivation" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Motivation </h2> <p>The following tasks require metatype-like types:</p> <ol> <li>Explicit specialization of functions and expressing specific static types.</li> <li>Dynamic dispatch of <code class="highlighter-rouge">static</code> methods.</li> <li>Representing any value as a tree, for debug purposes.</li> <li>Retrieving and passing around information about dynamic types - Reflection.</li> </ol> <p>Current state of things:</p> <p>[1] is given to metatypes <code class="highlighter-rouge">T.Type</code>:</p> <ul> <li>The metatype instance is usually ignored.</li> <li>For example, if you pass <code class="highlighter-rouge">Derived.self as Base.self</code> into function taking <code class="highlighter-rouge">T.Type</code>, it will work with <code class="highlighter-rouge">Base</code>.</li> <li>This raises concerns: are metatypes perfectly suited for that purpose?</li> </ul> <p>[2] is also given to metatypes <code class="highlighter-rouge">T.Type</code>:</p> <ul> <li>Because they are used so often, its tempting to add useful methods to them, but we cant, because metatypes are not extensible types.</li> </ul> <p>[3] is given to <code class="highlighter-rouge">Mirror</code>:</p> <ul> <li>Does its name reflect what its intended to do?</li> <li><code class="highlighter-rouge">Mirror.DisplayStyle</code> contains <code class="highlighter-rouge">optional</code> and <code class="highlighter-rouge">set</code> as special cases, but does not contain <code class="highlighter-rouge">function</code> at all.</li> <li><code class="highlighter-rouge">Mirror</code> collects all information possible at initialization, while for true reflection we want <em>laziness</em>.</li> <li><code class="highlighter-rouge">Mirror</code> allows customization. For example, <code class="highlighter-rouge">Array&lt;T&gt;</code> is represented with a field for each of its elements. Do we want this for true reflection we want to add in the future?</li> </ul> <p>[4] is given to both metatypes <code class="highlighter-rouge">T.Type</code> and <code class="highlighter-rouge">Mirror</code>:</p> <ul> <li>Metatypes are generic. But do we want genericity in reflection? No, we almost always want to cast to <code class="highlighter-rouge">Any.Type</code>.</li> <li>Metatypes are used for getting both static and dynamic sizes.</li> <li>In this context, distinction between generic parameter <code class="highlighter-rouge">T</code> and value of metatype instance is unclear.</li> <li>People are confused that <code class="highlighter-rouge">Mirror</code> is intended to be used for full-featured reflection, while it does not aim for that.</li> </ul> <h3 id="known-issues-of-metatypes"> <a href="#known-issues-of-metatypes" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Known issues of metatypes: </h3> <p>Assume this function that checks if an <code class="highlighter-rouge">Int</code> type conforms to a specific protocol. This check uses current model of metatypes combined in a generic context:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="n">intConforms</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">to</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="k">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
   <span class="k">return</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span> <span class="k">is</span> <span class="kt">T</span><span class="o">.</span><span class="k">Type</span>
<span class="p">}</span>

<span class="nf">intConforms</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">CustomStringConvertible</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="c1">//=&gt; FALSE</span>
</code></pre></div></div> <blockquote> <p>[1] When <code class="highlighter-rouge">T</code> is a protocol <code class="highlighter-rouge">P</code>, <code class="highlighter-rouge">T.Type</code> is the metatype of the protocol type itself, <code class="highlighter-rouge">P.Protocol</code>. <code class="highlighter-rouge">Int.self</code> is not <code class="highlighter-rouge">P.self</code>.</p> <p>[2] There isnt a way to generically expression <code class="highlighter-rouge">P.Type</code> <strong>yet</strong>.</p> <p>[3] The syntax would have to be changed in the compiler to get something that behaves like <code class="highlighter-rouge">.Type</code> today.</p> <p>Written by Joe Groff: <a href="https://twitter.com/jckarter/status/754420461404958721">[1]</a> <a href="https://twitter.com/jckarter/status/754420624261472256">[2]</a> <a href="https://twitter.com/jckarter/status/754425573762478080">[3]</a></p> </blockquote> <p>A possible workaround might look like the example below, but does not allow to decompose <code class="highlighter-rouge">P.Type</code> which is a major implementation problem of this proposal:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="n">intConforms</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">to</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="k">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span> <span class="k">is</span> <span class="kt">T</span>
<span class="p">}</span>

<span class="nf">intConforms</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">CustomStringConvertible</span><span class="o">.</span><span class="k">Type</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="c1">//=&gt; TRUE</span>
</code></pre></div></div> <p>This issue was first found and documented as a strange issue in <strong><a href="https://bugs.swift.org/browse/SR-2085">SR-2085</a></strong>. It also raises the concerns: do we need <code class="highlighter-rouge">.Protocol</code> at all?</p> <p>We can extend this issue and find the second problem by checking against the metatype of <code class="highlighter-rouge">Any</code>:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="n">intConforms</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">to</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="k">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span> <span class="k">is</span> <span class="kt">T</span>
<span class="p">}</span>

<span class="nf">intConforms</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Any</span><span class="o">.</span><span class="k">Type</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="c1">//=&gt; TRUE</span>

<span class="nf">intConforms</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Any</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="c1">//=&gt; TRUE</span>
</code></pre></div></div> <p>As you clearly can see, when using <code class="highlighter-rouge">Any</code> the compiler does not require <code class="highlighter-rouge">.Type</code> at all.</p> <p>The third issue will show itself whenever we would try to check protocol relationship with another protocol. Currently there is no way (that we know of) to solve this problem:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">P</span> <span class="p">{}</span>
<span class="kd">protocol</span> <span class="kt">R</span> <span class="p">:</span> <span class="kt">P</span> <span class="p">{}</span>

<span class="kd">func</span> <span class="n">rIsSubtype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">of</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="k">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="kt">R</span><span class="o">.</span><span class="k">self</span> <span class="k">is</span> <span class="kt">T</span>
<span class="p">}</span>

<span class="nf">rIsSubtype</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="kt">P</span><span class="o">.</span><span class="k">Type</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="c1">//=&gt; FALSE</span>
</code></pre></div></div> <p>We also believe that this issue is also the reason why the current global functions <code class="highlighter-rouge">sizeof</code>, <code class="highlighter-rouge">strideof</code> and <code class="highlighter-rouge">alignof</code> make use of generic <code class="highlighter-rouge">&lt;T&gt;(_: T.Type)</code> declaration notation instead of <code class="highlighter-rouge">(_: Any.Type)</code>.</p> <h2 id="proposed-solution"> <a href="#proposed-solution" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Proposed solution </h2> <h3 id="metatypet"> <a href="#metatypet" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> <code class="highlighter-rouge">Metatype&lt;T&gt;</code>: </h3> <ul> <li>Revise metatypes in generic context so the old <code class="highlighter-rouge">T.Type</code> notation does not produce <code class="highlighter-rouge">T.Protocol</code> when a protocol metatype is passed around.</li> <li>Introduce a distinction between <strong>public</strong> and <strong>internal</strong> <code class="highlighter-rouge">T.self</code> notation where the <strong>internal</strong> <code class="highlighter-rouge">T.self</code> notation will be renamed to <code class="highlighter-rouge">T.metatype</code>.</li> <li>Rename old metatype <code class="highlighter-rouge">T.Type</code> notation to <code class="highlighter-rouge">Metatype&lt;T&gt;</code>.</li> <li>Make <strong>internal</strong> <code class="highlighter-rouge">T.metatype</code> notation (builtin - not visible in public Swift) return an instance of <code class="highlighter-rouge">Metatype&lt;T&gt;</code>.</li> <li>Public construction of metatypes will look like <code class="highlighter-rouge">Type&lt;T&gt;.metatype</code> or <code class="highlighter-rouge">T.self.metatype</code>, see below.</li> <li>Metatypes will be used <strong>only</strong> for dynamic dispatch of static methods, see example below:</li> </ul> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">HasStatic</span>   <span class="p">{</span> <span class="kd">static</span> <span class="kd">func</span> <span class="nf">staticMethod</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span><span class="p">;</span> <span class="nf">init</span><span class="p">()</span> <span class="p">}</span>
<span class="kd">struct</span> <span class="kt">A</span> <span class="p">:</span> <span class="kt">HasStatic</span> <span class="p">{</span> <span class="kd">static</span> <span class="kd">func</span> <span class="nf">staticMethod</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">return</span> <span class="s">"I am A"</span> <span class="p">};</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{}</span> <span class="p">}</span>
<span class="kd">struct</span> <span class="kt">B</span> <span class="p">:</span> <span class="kt">HasStatic</span> <span class="p">{</span> <span class="kd">static</span> <span class="kd">func</span> <span class="nf">staticMethod</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">return</span> <span class="s">"I am B"</span> <span class="p">};</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{}</span> <span class="p">}</span>

<span class="kd">func</span> <span class="nf">callStatic</span><span class="p">(</span><span class="n">_</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">HasStatic</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">metatype</span><span class="o">.</span><span class="nf">staticMethod</span><span class="p">()</span>   
    <span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">instance</span> <span class="o">=</span> <span class="n">metatype</span><span class="o">.</span><span class="nf">init</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">a</span> <span class="o">=</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">A</span><span class="o">&gt;.</span><span class="n">metatype</span>
<span class="k">let</span> <span class="nv">b</span> <span class="o">=</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">B</span><span class="o">&gt;.</span><span class="n">metatype</span>
<span class="nf">callStatic</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1">//=&gt; "I am A" "A()"</span>
<span class="nf">callStatic</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c1">//=&gt; "A am B" "B()"</span>
</code></pre></div></div> <h3 id="typet-api"> <a href="#typet-api" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> <code class="highlighter-rouge">Type&lt;T&gt;</code> API: </h3> <p><code class="highlighter-rouge">T.self</code> will be repurposed to return ab instance of <code class="highlighter-rouge">Type&lt;T&gt;</code> that is declared as follows:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt">Hashable</span><span class="p">,</span> <span class="kt">CustomStringConvertible</span><span class="p">,</span> <span class="kt">CustomDebugStringConvertible</span> <span class="p">{</span>
	
	<span class="c1">/// Creates an instance that reflects `T`.</span>
	<span class="c1">/// Example: `let type = T.self`</span>
	<span class="kd">public</span> <span class="nf">init</span><span class="p">()</span>
	
	<span class="c1">/// Returns the contiguous memory footprint of `T`.</span>
	<span class="c1">///</span>
	<span class="c1">/// Does not include any dynamically-allocated or "remote" storage.</span>
	<span class="c1">/// In particular, `Type&lt;T&gt;.size`, when `T` is a class type, is the</span>
	<span class="c1">/// same regardless of how many stored properties `T` has.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the least possible interval between distinct instances of</span>
	<span class="c1">/// `T` in memory.  The result is always positive.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">stride</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the default memory alignment of `T`.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">alignment</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns an instance of `Metatype&lt;T&gt;` from captured `T` literal.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the contiguous memory footprint of `T`.</span>
	<span class="c1">///</span>
	<span class="c1">/// Does not include any dynamically-allocated or "remote" storage.</span>
	<span class="c1">/// In particular, `Type&lt;T&gt;().size`, when `T` is a class type, is the</span>
	<span class="c1">/// same regardless of how many stored properties `T` has.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the least possible interval between distinct instances of</span>
	<span class="c1">/// `T` in memory.  The result is always positive.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">stride</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the default memory alignment of `T`.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">alignment</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns an instance of `Metatype&lt;T&gt;` from captured `T` literal.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Hash values are not guaranteed to be equal across different executions of</span>
	<span class="c1">/// your program. Do not save hash values to use during a future execution.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">hashValue</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">description</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`, suitable for debugging.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">debugDescription</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">func</span> <span class="o">==&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
</code></pre></div></div> <p>Size of <code class="highlighter-rouge">Type&lt;T&gt;</code> struct equals <code class="highlighter-rouge">0</code>. It will be used for generic function specialization:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">performWithType</span><span class="p">(</span><span class="n">_</span> <span class="nv">type</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span>
<span class="nf">performWithType</span><span class="p">(</span><span class="kt">Float</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metatypeof-function"> <a href="#metatypeof-function" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> <code class="highlighter-rouge">metatype(of:)</code> function: </h3> <p>The global <code class="highlighter-rouge">type(of:)</code> function from <strong>SE-0096</strong> will be renamed to <code class="highlighter-rouge">metatype(of:)</code> and receive the following declaration:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">/// Returns a dynamic instance of `Metatype&lt;T&gt;`. A dynamic</span>
<span class="c1">/// metatype can reflect type `U` where `U : T`.</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="n">metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">of</span> <span class="nv">instance</span><span class="p">:</span> <span class="kt">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span>
</code></pre></div></div> <h3 id="mirror-api"> <a href="#mirror-api" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> <code class="highlighter-rouge">Mirror</code> API: </h3> <p>Rename current <code class="highlighter-rouge">Mirror</code> (Swift 2.2) to <code class="highlighter-rouge">DebugRepresentation</code> and <code class="highlighter-rouge">CustomReflectable</code> to <code class="highlighter-rouge">CustomDebugRepresentable</code>.</p> <p>A <em>completely different</em> <code class="highlighter-rouge">Mirror</code> type will be introduced in Swift 3.</p> <ul> <li><code class="highlighter-rouge">Mirror</code> wraps metatypes and allows checking subtype relationships at runtime.</li> <li><code class="highlighter-rouge">Mirror</code> contains dynamic versions of <code class="highlighter-rouge">size</code>, <code class="highlighter-rouge">stride</code> and <code class="highlighter-rouge">alignment</code>.</li> <li>Size of <code class="highlighter-rouge">Mirror</code> itself is always <code class="highlighter-rouge">8</code> bytes, because it only needs to store a single metatype.</li> <li><code class="highlighter-rouge">Mirror</code> provides a starting point for adding fully functional (lazy) reflection in the future.</li> </ul> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Mirror</span> <span class="p">:</span> <span class="kt">Hashable</span><span class="p">,</span> <span class="kt">CustomStringConvertible</span><span class="p">,</span> <span class="kt">CustomDebugStringConvertible</span> <span class="p">{</span>

	<span class="c1">/// Creates an instance of `Mirror`, reflecting type, which is</span>
	<span class="c1">/// reflected by a metatype.</span>
	<span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span>
	
	<span class="c1">/// Creates an instance of `Mirror`, reflecting type `T`</span>
	<span class="kd">public</span> <span class="kd">init</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">type</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span>
	
	<span class="c1">/// Creates an instance of `Mirror`, reflecting </span>
	<span class="c1">/// dynamic metatype of a given instance.</span>
	<span class="kd">public</span> <span class="kd">init</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reflecting</span> <span class="nv">instance</span><span class="p">:</span> <span class="kt">T</span><span class="p">)</span>
	
	<span class="c1">/// Returns the contiguous memory footprint of reflected metatype.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the least possible interval between distinct instances of</span>
	<span class="c1">/// the dynamic type in memory calculated from the reflected dynamic </span>
	<span class="c1">/// metatype. The result is always positive.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">stride</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the minimum memory alignment of the reflected dynamic </span>
	<span class="c1">/// metatype.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">alignment</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Returns an instance of `Metatype&lt;Any&gt;` from reflected dynamic metatype.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Checks if type reflected by `self` is a subtype of type reflected by another `Mirror`.</span>
	<span class="kd">public</span> <span class="kd">func</span> <span class="p">`</span><span class="nv">is</span><span class="p">`(</span><span class="n">_</span> <span class="nv">mirror</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Checks if type reflected by `self` is a subtype of `T`.</span>
	<span class="kd">public</span> <span class="kd">func</span> <span class="p">`</span><span class="nv">is</span><span class="p">`</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">type</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Checks if type reflected by `self` is a subtype of type reflected by a metatype.</span>
	<span class="kd">public</span> <span class="kd">func</span> <span class="p">`</span><span class="nv">is</span><span class="p">`</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// Hash values are not guaranteed to be equal across different executions of</span>
	<span class="c1">/// your program. Do not save hash values to use during a future execution.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">hashValue</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">description</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`, suitable for debugging.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">debugDescription</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">func</span> <span class="o">==</span><span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
</code></pre></div></div> <h3 id="summary-of-metatype-like-types"> <a href="#summary-of-metatype-like-types" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Summary of metatype-like types: </h3> <h4 id="before"> <a href="#before" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Before </h4> <ul> <li><code class="highlighter-rouge">T.Type</code> does three things: <ol> <li>Specialization of functions.</li> <li>Dynamic dispatch of static methods.</li> <li>Partial reflection using dynamic casts and functions like <code class="highlighter-rouge">sizeof</code>, <code class="highlighter-rouge">strideof</code> etc.</li> </ol> </li> <li><code class="highlighter-rouge">Mirror</code> does two things: <ol> <li>It is primarily intended for use in debugging, like <code class="highlighter-rouge">PlaygroundQuickLook</code>.</li> <li>With less success, it can be used for reflection.</li> </ol> </li> </ul> <h4 id="after"> <a href="#after" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> After </h4> <ul> <li><code class="highlighter-rouge">Type&lt;T&gt;</code> does specialization of functions.</li> <li><code class="highlighter-rouge">Mirror</code> does reflection.</li> <li><code class="highlighter-rouge">Metatype&lt;T&gt;</code> does dynamic dispatch of static methods.</li> <li><code class="highlighter-rouge">DebugRepresentation</code> is used in debugging.</li> </ul> <h2 id="detailed-design"> <a href="#detailed-design" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Detailed design </h2> <h3 id="possible-implementation"> <a href="#possible-implementation" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Possible Implementation: </h3> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt">Hashable</span><span class="p">,</span> <span class="kt">CustomStringConvertible</span><span class="p">,</span> <span class="kt">CustomDebugStringConvertible</span> <span class="p">{</span>
	
	<span class="c1">/// Creates an instance that reflects `T`.</span>
	<span class="c1">/// Example: `let type = T.self`</span>
	<span class="kd">public</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{}</span>
	
	<span class="c1">/// Returns the contiguous memory footprint of `T`.</span>
	<span class="c1">///</span>
	<span class="c1">/// Does not include any dynamically-allocated or "remote" storage.</span>
	<span class="c1">/// In particular, `Type&lt;T&gt;.size`, when `T` is a class type, is the</span>
	<span class="c1">/// same regardless of how many stored properties `T` has.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_size</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the least possible interval between distinct instances of</span>
	<span class="c1">/// `T` in memory.  The result is always positive.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">stride</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_stride</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the default memory alignment of `T`.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">alignment</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_alignment</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="kt">T</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// Returns an instance of `Metatype&lt;T&gt;` from captured `T` literal.</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">T</span><span class="o">.</span><span class="n">metatype</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the contiguous memory footprint of `T`.</span>
	<span class="c1">///</span>
	<span class="c1">/// Does not include any dynamically-allocated or "remote" storage.</span>
	<span class="c1">/// In particular, `Type&lt;T&gt;().size`, when `T` is a class type, is the</span>
	<span class="c1">/// same regardless of how many stored properties `T` has.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;.</span><span class="n">size</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the least possible interval between distinct instances of</span>
	<span class="c1">/// `T` in memory.  The result is always positive.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">stride</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;.</span><span class="n">stride</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the default memory alignment of `T`.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">alignment</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;.</span><span class="n">alignment</span> <span class="p">}</span>
	
	<span class="c1">/// Returns an instance of `Metatype&lt;T&gt;` from captured `T` literal.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;.</span><span class="n">metatype</span> <span class="p">}</span>
	
	<span class="c1">/// Hash values are not guaranteed to be equal across different executions of</span>
	<span class="c1">/// your program. Do not save hash values to use during a future execution.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">hashValue</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_uniqueIdentifier</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">description</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">return</span> <span class="s">"Type&lt;</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">metatype</span><span class="se">)</span><span class="s">&gt;()"</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`, suitable for debugging.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">debugDescription</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
		<span class="k">return</span> <span class="s">"["</span> <span class="o">+</span> <span class="k">self</span><span class="o">.</span><span class="n">description</span>
			<span class="o">+</span> <span class="s">" metatype: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">metatype</span><span class="se">)</span><span class="s">"</span>
			<span class="o">+</span> <span class="s">" size: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">size</span><span class="se">)</span><span class="s">"</span>
			<span class="o">+</span> <span class="s">" stride: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">stride</span><span class="se">)</span><span class="s">"</span>
			<span class="o">+</span> <span class="s">" alignment: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">alignment</span><span class="se">)</span><span class="s">]"</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">func</span> <span class="o">==&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">true</span> <span class="p">}</span>

<span class="c1">/// Returns a dynamic instance of `Metatype&lt;T&gt;`. A dynamic</span>
<span class="c1">/// metatype can reflect type `U` where `U : T`.</span>
<span class="kd">public</span> <span class="kd">func</span> <span class="n">metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">of</span> <span class="nv">instance</span><span class="p">:</span> <span class="kt">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span>
	<span class="k">return</span> <span class="cm">/* implement */</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Mirror</span> <span class="p">:</span> <span class="kt">Hashable</span><span class="p">,</span> <span class="kt">CustomStringConvertible</span><span class="p">,</span> <span class="kt">CustomDebugStringConvertible</span> <span class="p">{</span>
	
	<span class="c1">/// Storage for any dynamic metatype.</span>
	<span class="kd">internal</span> <span class="k">let</span> <span class="nv">_metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span>
	
	<span class="c1">/// Creates an instance of `Mirror`, reflecting type, which is</span>
	<span class="c1">/// reflected by a metatype.</span>
	<span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">self</span><span class="o">.</span><span class="n">_metatype</span> <span class="o">=</span> <span class="n">metatype</span>
	<span class="p">}</span>
	
	<span class="c1">/// Creates an instance of `Mirror`, reflecting type `T`</span>
	<span class="kd">public</span> <span class="kd">init</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">type</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">self</span><span class="o">.</span><span class="n">_metatype</span> <span class="o">=</span> <span class="n">type</span><span class="o">.</span><span class="n">metatype</span>
	<span class="p">}</span>
	
	<span class="c1">/// Creates an instance of `Mirror`, reflecting </span>
	<span class="c1">/// dynamic type of a given instance.</span>
	<span class="kd">public</span> <span class="kd">init</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">reflecting</span> <span class="nv">instance</span><span class="p">:</span> <span class="kt">T</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">self</span><span class="o">.</span><span class="n">_metatype</span> <span class="o">=</span> <span class="nf">metatype</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="n">instance</span><span class="p">)</span>
	<span class="p">}</span>
	
	<span class="c1">/// Returns the contiguous memory footprint of reflected metatype.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_size</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the least possible interval between distinct instances of</span>
	<span class="c1">/// the dynamic type in memory calculated from the reflected dynamic </span>
	<span class="c1">/// metatype. The result is always positive.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">stride</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_stride</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// Returns the minimum memory alignment of the reflected dynamic </span>
	<span class="c1">/// metatype.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">alignment</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_alignment</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// Returns an instance of `Metatype&lt;T&gt;` from reflected dynamic metatype.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Any</span><span class="o">.</span><span class="k">Type</span> <span class="p">{</span> <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span> <span class="p">}</span>
	
	<span class="c1">/// Checks if type reflected by `self` is a subtype of type reflected by another `Mirror`.</span>
	<span class="kd">public</span> <span class="kd">func</span> <span class="p">`</span><span class="nv">is</span><span class="p">`(</span><span class="n">_</span> <span class="nv">mirror</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nf">_is</span><span class="p">(</span><span class="nv">metatype</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">,</span> <span class="nv">also</span><span class="p">:</span> <span class="n">mirror</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span>
	<span class="p">}</span>
	
	<span class="c1">/// Checks if type reflected by `self` is a subtype of `T`.</span>
	<span class="kd">public</span> <span class="kd">func</span> <span class="p">`</span><span class="nv">is</span><span class="p">`</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">type</span><span class="p">:</span> <span class="k">Type</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nf">_is</span><span class="p">(</span><span class="nv">metatype</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">,</span> <span class="nv">also</span><span class="p">:</span> <span class="n">type</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span>
	<span class="p">}</span>
	
	<span class="c1">/// Checks if type reflected by `self` is a subtype of type reflected by a metatype.</span>
	<span class="kd">public</span> <span class="kd">func</span> <span class="p">`</span><span class="nv">is</span><span class="p">`</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nf">_is</span><span class="p">(</span><span class="nv">metatype</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">,</span> <span class="nv">also</span><span class="p">:</span> <span class="n">metatype</span><span class="p">)</span>
	<span class="p">}</span>
	
	<span class="c1">/// Hash values are not guaranteed to be equal across different executions of</span>
	<span class="c1">/// your program. Do not save hash values to use during a future execution.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">hashValue</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">_uniqueIdentifier</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="p">)</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">description</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span> <span class="k">return</span> <span class="s">"Mirror(</span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="se">)</span><span class="s">)"</span> <span class="p">}</span>
	
	<span class="c1">/// A textual representation of `self`, suitable for debugging.</span>
	<span class="kd">public</span> <span class="k">var</span> <span class="nv">debugDescription</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
		<span class="k">return</span> <span class="s">"["</span> <span class="o">+</span> <span class="k">self</span><span class="o">.</span><span class="n">description</span>
			<span class="o">+</span> <span class="s">" metatype: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">_metatype</span><span class="se">)</span><span class="s">"</span>
			<span class="o">+</span> <span class="s">" size: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">size</span><span class="se">)</span><span class="s">"</span>
			<span class="o">+</span> <span class="s">" stride: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">stride</span><span class="se">)</span><span class="s">"</span>
			<span class="o">+</span> <span class="s">" alignment: </span><span class="se">\(</span><span class="k">self</span><span class="o">.</span><span class="n">alignment</span><span class="se">)</span><span class="s">]"</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">func</span> <span class="o">==</span><span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">lhs</span><span class="o">.</span><span class="n">hashValue</span> <span class="o">==</span> <span class="n">rhs</span><span class="o">.</span><span class="n">hashValue</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="internal-functions"> <a href="#internal-functions" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Internal functions: </h3> <p>These functions were used in the implementation above to calculate metatype related information.</p> <ul> <li> <p><code class="highlighter-rouge">_size(of:)</code>, <code class="highlighter-rouge">_stride(of:)</code> and <code class="highlighter-rouge">_alignment(of:)</code> functions need some additional tweaking so they will work with any matatype stored in an instance of <code class="highlighter-rouge">Metatype&lt;Any&gt;</code> rather than a dynamic <code class="highlighter-rouge">&lt;T&gt;(of metatype: Metatype&lt;T&gt;)</code> variant, which is not suitable for calculations needed in <code class="highlighter-rouge">Mirror</code>.</p> </li> <li> <p><code class="highlighter-rouge">_uniqueIdentifier(for:)</code> function is fully implemented and should just work when the current generic issue with <code class="highlighter-rouge">.Protocol</code> metatypes is resolved.</p> </li> <li> <p><code class="highlighter-rouge">_is(metatype:also:)</code> relies on the resolved <code class="highlighter-rouge">.Protocol</code> issue. The final implementation should allow to check type relationship between two different metatype instances.</p> </li> </ul> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">internal</span> <span class="kd">func</span> <span class="nf">_size</span><span class="p">(</span><span class="n">of</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
	<span class="c1">// Fix this to allow any metatype</span>
	<span class="k">return</span> <span class="kt">Int</span><span class="p">(</span><span class="kt">Builtin</span><span class="o">.</span><span class="nf">sizeof</span><span class="p">(</span><span class="n">metatype</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">internal</span> <span class="kd">func</span> <span class="nf">_stride</span><span class="p">(</span><span class="n">of</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
	<span class="c1">// Fix this to allow any metatype</span>
	<span class="k">return</span> <span class="kt">Int</span><span class="p">(</span><span class="kt">Builtin</span><span class="o">.</span><span class="nf">strideof_nonzero</span><span class="p">(</span><span class="n">metatype</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">internal</span> <span class="kd">func</span> <span class="nf">_alignment</span><span class="p">(</span><span class="n">of</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
	<span class="c1">// Fix this to allow any metatype</span>
	<span class="k">return</span> <span class="kt">Int</span><span class="p">(</span><span class="kt">Builtin</span><span class="o">.</span><span class="nf">alignof</span><span class="p">(</span><span class="n">metatype</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">internal</span> <span class="kd">func</span> <span class="nf">_uniqueIdentifier</span><span class="p">(</span><span class="k">for</span> <span class="nv">metatype</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
	<span class="k">let</span> <span class="nv">rawPointerMetatype</span> <span class="o">=</span> <span class="nf">unsafeBitCast</span><span class="p">(</span><span class="n">metatype</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="kt">Builtin</span><span class="o">.</span><span class="kt">RawPointer</span><span class="o">.</span><span class="n">metatype</span><span class="p">)</span>
	<span class="k">return</span> <span class="kt">Int</span><span class="p">(</span><span class="kt">Builtin</span><span class="o">.</span><span class="nf">ptrtoint_Word</span><span class="p">(</span><span class="n">rawPointerMetatype</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">internal</span> <span class="kd">func</span> <span class="nf">_is</span><span class="p">(</span><span class="n">metatype</span> <span class="nv">m1</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">also</span> <span class="nv">m2</span><span class="p">:</span> <span class="kt">Metatype</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="cm">/* implement - checks type ralationship `M1 : M2` and `M1 == M2` */</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="summary-of-steps"> <a href="#summary-of-steps" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Summary of Steps: </h3> <ul> <li>Revise metatypes in generic context so the old <code class="highlighter-rouge">T.Type</code> notation does not produce <code class="highlighter-rouge">T.Protocol</code> when a protocol metatype is passed around.</li> <li>Make <strong>public</strong> <code class="highlighter-rouge">T.self</code> notation return an instance of <code class="highlighter-rouge">Type&lt;T&gt;</code>.</li> <li>Rename <strong>internal</strong> <code class="highlighter-rouge">T.self</code> notation to <code class="highlighter-rouge">T.metatype</code> (builtin - not visible in public Swift).</li> <li>Rename old metatype <code class="highlighter-rouge">T.Type</code> notation to <code class="highlighter-rouge">Metatype&lt;T&gt;</code>.</li> <li>Make <strong>internal</strong> <code class="highlighter-rouge">T.metatype</code> notation return an instance of <code class="highlighter-rouge">Metatype&lt;T&gt;</code>.</li> <li>Revise APIs with current <code class="highlighter-rouge">T.Type</code> notation to use <code class="highlighter-rouge">Type&lt;T&gt;</code> and in few edge cases <code class="highlighter-rouge">Metatype&lt;T&gt;</code>.</li> <li>Move <code class="highlighter-rouge">size</code>, <code class="highlighter-rouge">stride</code> and <code class="highlighter-rouge">alignment</code> from <strong>SE-0101</strong> to <code class="highlighter-rouge">Type&lt;T&gt;</code>.</li> <li>Provide a concrete declaration for <strong>SE-0096</strong> and rename it to <code class="highlighter-rouge">metatype(of:)</code>.</li> <li>Rename current <code class="highlighter-rouge">Mirror</code> type (Swift 2.2) to <code class="highlighter-rouge">DebugRepresentation</code> and <code class="highlighter-rouge">CustomReflectable</code> to <code class="highlighter-rouge">CustomDebugRepresentable</code>.</li> <li>Introduce a new <code class="highlighter-rouge">Mirror</code> type that is intended to replace metatypes for most use cases and extended with reflection in a future release.</li> </ul> <h2 id="impact-on-existing-code"> <a href="#impact-on-existing-code" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Impact on existing code </h2> <p>This is a source-breaking change that can be automated by a migrator.</p> <p>The following steps reflects our suggestion of the migration process; these can differ from the final migration process implemented by the core team if this proposal will be accepted:</p> <ul> <li><code class="highlighter-rouge">T.Type</code>  <code class="highlighter-rouge">Metatype&lt;T&gt;</code></li> <li><code class="highlighter-rouge">T.self</code>  <code class="highlighter-rouge">Type&lt;T&gt;.metatype</code></li> <li><code class="highlighter-rouge">Mirror</code>  <code class="highlighter-rouge">DebugRepresentation</code></li> <li><code class="highlighter-rouge">CustomReflectable</code>  <code class="highlighter-rouge">CustomDebugRepresentable</code> <ul> <li><code class="highlighter-rouge">customMirror</code>  <code class="highlighter-rouge">customDebugRepresentation</code></li> </ul> </li> <li><code class="highlighter-rouge">sizeof(T.self)</code>  <code class="highlighter-rouge">Type&lt;T&gt;.size</code></li> <li><code class="highlighter-rouge">sizeof(metatype)</code>  <code class="highlighter-rouge">Mirror(metatype).size</code></li> </ul> <h3 id="migrating-metatype-variables-to-use-typet-and-mirror"> <a href="#migrating-metatype-variables-to-use-typet-and-mirror" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Migrating metatype variables to use <code class="highlighter-rouge">Type&lt;T&gt;</code> and <code class="highlighter-rouge">Mirror</code> </h3> <p><code class="highlighter-rouge">Metatype&lt;T&gt;</code> is a safe default for transition, but we want to discourage usage of metatypes. In some cases, we can provide fix-its to replace usage of <code class="highlighter-rouge">Metatype&lt;T&gt;</code> with <code class="highlighter-rouge">Type&lt;T&gt;</code> or <code class="highlighter-rouge">Mirror</code>.</p> <p>To change type of a variable named <code class="highlighter-rouge">type</code> from <code class="highlighter-rouge">Metatype&lt;T&gt;</code> to <code class="highlighter-rouge">Type&lt;T&gt;</code>:</p> <ol> <li>Replace its type with <code class="highlighter-rouge">Type&lt;T&gt;</code>.</li> <li>Use the migration patterns below.</li> <li>If some use case does not match any of these, the variable cannot be migrated to type <code class="highlighter-rouge">Type&lt;T&gt;</code>.</li> </ol> <p>Migration patterns:</p> <ul> <li><code class="highlighter-rouge">type = T.self.metatype</code>  <code class="highlighter-rouge">type = T.self</code></li> <li><code class="highlighter-rouge">type = U.self.metatype</code> where <code class="highlighter-rouge">U != T</code>  Automatic migration impossible</li> <li><code class="highlighter-rouge">type = Type&lt;T&gt;.metatype</code>  <code class="highlighter-rouge">type = T.self</code></li> <li><code class="highlighter-rouge">type = Type&lt;U&gt;.metatype</code> where <code class="highlighter-rouge">U != T</code>  Automatic migration impossible</li> <li><code class="highlighter-rouge">type = otherMetatype</code> where <code class="highlighter-rouge">otherMetatype: Metatype&lt;T&gt;</code>  <code class="highlighter-rouge">type = T.self</code></li> <li><code class="highlighter-rouge">type = otherMetatype</code> where <code class="highlighter-rouge">otherMetatype: Metatype&lt;U&gt;</code>, <code class="highlighter-rouge">U != T</code>  Automatic migration impossible</li> <li><code class="highlighter-rouge">type = mirror.metatype</code> where <code class="highlighter-rouge">mirror: Mirror</code>  Automatic migration impossible</li> <li><code class="highlighter-rouge">otherMetatype = type</code> where <code class="highlighter-rouge">otherMetatype: Metatype&lt;U&gt;</code>  <code class="highlighter-rouge">otherMetatype = Type&lt;T&gt;.metatype</code></li> <li><code class="highlighter-rouge">Mirror(type)</code>  <code class="highlighter-rouge">Mirror(type)</code></li> <li><code class="highlighter-rouge">type as otherMetatype</code> where <code class="highlighter-rouge">otherMetatype: Metatype&lt;U&gt;</code>  <code class="highlighter-rouge">type.metatype as metatype&lt;U&gt;</code></li> <li><code class="highlighter-rouge">type as? otherMetatype</code>  Automatic migration impossible</li> <li><code class="highlighter-rouge">type as! otherMetatype</code>  Automatic migration impossible</li> <li><code class="highlighter-rouge">type is otherMetatype</code>  Automatic migration impossible</li> </ul> <p>How to change type of a variable named <code class="highlighter-rouge">type</code> from <code class="highlighter-rouge">Metatype&lt;T&gt;</code> to <code class="highlighter-rouge">Mirror</code>:</p> <ol> <li>Replace its type with <code class="highlighter-rouge">Mirror</code>.</li> <li>Use the migration patterns below.</li> <li>If some use case does not match any of these, the variable cannot be migrated to type <code class="highlighter-rouge">Mirror</code>.</li> </ol> <p>Migration patterns:</p> <ul> <li><code class="highlighter-rouge">type: Metatype&lt;T&gt;</code>  <code class="highlighter-rouge">type: Mirror</code></li> <li><code class="highlighter-rouge">type = U.self.metatype</code>  <code class="highlighter-rouge">type = Mirror(U.self)</code></li> <li><code class="highlighter-rouge">type = Type&lt;U&gt;.metatype</code>  <code class="highlighter-rouge">type = Mirror(U.self)</code></li> <li><code class="highlighter-rouge">type = otherMetatype</code>  <code class="highlighter-rouge">type = Mirror(otherMetatype)</code></li> <li><code class="highlighter-rouge">type = mirror.metatype</code> where <code class="highlighter-rouge">mirror: Mirror</code>  <code class="highlighter-rouge">type = mirror</code></li> <li><code class="highlighter-rouge">otherMetatype = type</code>  <code class="highlighter-rouge">otherMetatype = type.metatype</code></li> <li><code class="highlighter-rouge">Mirror(type)</code>  <code class="highlighter-rouge">type</code></li> <li><code class="highlighter-rouge">type as otherMetatype</code>  <code class="highlighter-rouge">type.metatype as! otherMetatype</code></li> <li><code class="highlighter-rouge">type as? otherMetatype</code>  <code class="highlighter-rouge">type.metatype as? otherMetatype</code></li> <li><code class="highlighter-rouge">type as! otherMetatype</code>  <code class="highlighter-rouge">type.metatype as! otherMetatype</code></li> <li><code class="highlighter-rouge">type is otherMetatype</code>  <code class="highlighter-rouge">type.is(otherMetatype)</code></li> </ul> <p>We can also migrate metatype parameters of a function, where assignment means passing an argument to that function.</p> <p>In two cases we can apply these automatically:</p> <ol> <li>If a generic function takes parameter <code class="highlighter-rouge">Metatype&lt;T&gt;</code>, then we can try to replace <code class="highlighter-rouge">Metatype&lt;T&gt;</code> with <code class="highlighter-rouge">Type&lt;T&gt;</code>.</li> <li>We can try to replace usage of <code class="highlighter-rouge">Metatype&lt;Any&gt;</code> (aka <code class="highlighter-rouge">AnyMetatype</code>) with <code class="highlighter-rouge">Mirror</code>.</li> </ol> <h2 id="alternatives-considered"> <a href="#alternatives-considered" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Alternatives considered </h2> <ul> <li> <p>After refactoring metatypes it is assumed that any metatype can be stored inside an instance of <code class="highlighter-rouge">Metatype&lt;Any&gt;</code>. If that will not be the case, then we propose to introduce a new standalone type for explained behavior. That type could be named as <code class="highlighter-rouge">AnyMetatype</code>. Therefore, any type marked with <code class="highlighter-rouge">Metatype&lt;Any&gt;</code> in this proposal will become <code class="highlighter-rouge">AnyMetatype</code>.</p> </li> <li> <p>If the community and the core team are strongly against the repurposing of <code class="highlighter-rouge">Mirror</code> wed like to consider to merge the proposed functionality into a single type. For such a change we do believe <code class="highlighter-rouge">Type&lt;T&gt;</code> might be the right type here. However, this introduces further complications such as storing dynamic metatypes inside of <code class="highlighter-rouge">Type&lt;T&gt;</code> and a few other that we dont want go in detail here.</p> </li> </ul> <h2 id="future-directions"> <a href="#future-directions" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Future directions </h2> <h3 id="remove-public-self"> <a href="#remove-public-self" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Remove public <code class="highlighter-rouge">.self</code>: </h3> <p>When <strong>SE-0090</strong> is accepted we will remove <code class="highlighter-rouge">T.self</code> notation and only have type literals like <code class="highlighter-rouge">T</code>.</p> <p>Examples:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">someInstance</span> <span class="o">=</span> <span class="nf">unsafeBitCast</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">dynamicSize</span> <span class="o">=</span> <span class="kt">Mirror</span><span class="p">(</span><span class="nv">reflecting</span><span class="p">:</span> <span class="n">someInstance</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
</code></pre></div></div> <p>Then we can add <code class="highlighter-rouge">Type(_: Type&lt;T&gt;)</code> initializer for disambiguation:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="o">.</span><span class="n">size</span>     <span class="c1">// Works fine with this proposal, but what if we drop `.self`?</span>
<span class="kt">Int</span><span class="o">.</span><span class="n">size</span>          <span class="c1">// Will be an error after dropping `.self`.</span>
<span class="k">Type</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">()</span><span class="o">.</span><span class="n">size</span>  <span class="c1">// Would work, but looks odd.</span>
<span class="kt">Type</span><span class="p">(</span><span class="kt">Int</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>    <span class="c1">// This version looks much better.</span>
</code></pre></div></div> <p>When combined with this proposal, the result will be to eliminate all magical members that existed in the language:</p> <ul> <li><code class="highlighter-rouge">.dynamicType</code></li> <li><code class="highlighter-rouge">.Type</code></li> <li><code class="highlighter-rouge">.self</code></li> </ul> <p>There is also <code class="highlighter-rouge">Self</code>, but it acts like an <code class="highlighter-rouge">associatedtype</code>.</p> <h3 id="extend-mirror-with-reflection-functionality"> <a href="#extend-mirror-with-reflection-functionality" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Extend <code class="highlighter-rouge">Mirror</code> with reflection functionality: </h3> <p>Reflection is one of stated goals for Swift 4. With this proposal, adding reflection becomes as simple as extending <code class="highlighter-rouge">Mirror</code>. For example, we could add the following computed property:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">typealias</span> <span class="kt">FieldDescriptor</span> <span class="o">=</span> <span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">Mirror</span><span class="p">,</span> <span class="nv">getter</span><span class="p">:</span> <span class="p">(</span><span class="kt">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">,</span> <span class="nv">setter</span><span class="p">:</span> <span class="p">(</span><span class="k">inout</span> <span class="kt">Any</span><span class="p">,</span> <span class="kt">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">())</span>
<span class="k">var</span> <span class="nv">fields</span><span class="p">:</span> <span class="p">[</span><span class="kt">FieldDescriptor</span><span class="p">]</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
</code></pre></div></div> </div> </div> </div> </div> </body> </html>
