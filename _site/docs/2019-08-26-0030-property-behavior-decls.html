<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>SE-0030 Property Behaviors - Swift Evolution List</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>SE-0030 Property Behaviors | Swift Evolution List</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="SE-0030 Property Behaviors" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Yuhuu!" /> <meta property="og:description" content="Yuhuu!" /> <link rel="canonical" href="http://localhost:4000/docs/2019-08-26-0030-property-behavior-decls.html" /> <meta property="og:url" content="http://localhost:4000/docs/2019-08-26-0030-property-behavior-decls.html" /> <meta property="og:site_name" content="Swift Evolution List" /> <script type="application/ld+json"> {"url":"http://localhost:4000/docs/2019-08-26-0030-property-behavior-decls.html","headline":"SE-0030 Property Behaviors","description":"Yuhuu!","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight">Swift Evolution List</a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item active"><a href="http://localhost:4000/404.html" class="navigation-list-link"></a></li><li class="navigation-list-item active"><a href="http://localhost:4000/" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="http://localhost:4000/about/" class="navigation-list-link">About</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0001-keywords-as-argument-labels.html" class="navigation-list-link">SE-0001 Allow (most) keywords as argument labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0002-remove-currying.html" class="navigation-list-link">SE-0002 Removing currying `func` declaration syntax</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0003-remove-var-parameters.html" class="navigation-list-link">SE-0003 Removing `var` from Function Parameters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0004-remove-pre-post-inc-decrement.html" class="navigation-list-link">SE-0004 Remove the `++` and `--` operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0005-objective-c-name-translation.html" class="navigation-list-link">SE-0005 Better Translation of Objective-C APIs Into Swift</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0006-apply-api-guidelines-to-the-standard-library.html" class="navigation-list-link">SE-0006 Apply API Guidelines to the Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0007-remove-c-style-for-loops.html" class="navigation-list-link">SE-0007 Remove C-style for-loops with conditions and incrementers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0008-lazy-flatmap-for-optionals.html" class="navigation-list-link">SE-0008 Add a Lazy flatMap for Sequences of Optionals #</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0009-require-self-for-accessing-instance-members.html" class="navigation-list-link">SE-0009 Require self for accessing instance members</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0010-add-staticstring-unicodescalarview.html" class="navigation-list-link">SE-0010 Add StaticString.UnicodeScalarView</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0011-replace-typealias-associated.html" class="navigation-list-link">SE-0011 Replace `typealias` keyword with `associatedtype` for associated type declarations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0012-add-noescape-to-public-library-api.html" class="navigation-list-link">SE-0012 Add `@noescape` to public library API</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0013-remove-partial-application-super.html" class="navigation-list-link">SE-0013 Remove Partial Application of Non-Final Super Methods (Swift 2.2)</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0014-constrained-AnySequence.html" class="navigation-list-link">SE-0014 Constraining `AnySequence.init`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0015-tuple-comparison-operators.html" class="navigation-list-link">SE-0015 Tuple comparison operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0016-initializers-for-converting-unsafe-pointers-to-ints.html" class="navigation-list-link">SE-0016 Add initializers to Int and UInt to convert from UnsafePointer and UnsafeMutablePointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0017-convert-unmanaged-to-use-unsafepointer.html" class="navigation-list-link">SE-0017 Change `Unmanaged` to use `UnsafePointer`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0018-flexible-memberwise-initialization.html" class="navigation-list-link">SE-0018 Flexible Memberwise Initialization</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0019-package-manager-testing.html" class="navigation-list-link">SE-0019 Swift Testing</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0020-if-swift-version.html" class="navigation-list-link">SE-0020 Swift Language Version Build Configuration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0021-generalized-naming.html" class="navigation-list-link">SE-0021 Naming Functions with Argument Labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0022-objc-selectors.html" class="navigation-list-link">SE-0022 Referencing the Objective-C selector of a method</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0023-api-guidelines.html" class="navigation-list-link">SE-0023 API Design Guidelines</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0024-optional-value-setter.html" class="navigation-list-link">SE-0024 Optional Value Setter `??=`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0025-scoped-access-level.html" class="navigation-list-link">SE-0025 Scoped Access Level</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0026-abstract-classes-and-methods.html" class="navigation-list-link">SE-0026 Abstract classes and methods</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0027-string-from-code-units.html" class="navigation-list-link">SE-0027 Expose code unit initializers on String</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0028-modernizing-debug-identifiers.html" class="navigation-list-link">SE-0028 Modernizing Swift's Debugging Identifiers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0029-remove-implicit-tuple-splat.html" class="navigation-list-link">SE-0029 Remove implicit tuple splat behavior from function applications</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/docs/2019-08-26-0030-property-behavior-decls.html" class="navigation-list-link active">SE-0030 Property Behaviors</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0031-adjusting-inout-declarations.html" class="navigation-list-link">SE-0031 Adjusting `inout` Declarations for Type Decoration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0032-sequencetype-find.html" class="navigation-list-link">SE-0032 Add `first(where:)` method to `Sequence`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0033-import-objc-constants.html" class="navigation-list-link">SE-0033 Import Objective-C Constants as Swift Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0034-disambiguating-line.html" class="navigation-list-link">SE-0034 Disambiguating Line Control Statements from Debugging Identifiers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0035-limit-inout-capture.html" class="navigation-list-link">SE-0035 Limiting `inout` capture to `@noescape` contexts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0036-enum-dot.html" class="navigation-list-link">SE-0036 Requiring Leading Dot Prefixes for Enum Instance Member Implementations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0037-clarify-comments-and-operators.html" class="navigation-list-link">SE-0037 Clarify interaction between comments & operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0038-swiftpm-c-language-targets.html" class="navigation-list-link">SE-0038 Package Manager C Language Target Support</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0039-playgroundliterals.html" class="navigation-list-link">SE-0039 Modernizing Playground Literals</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0040-attributecolons.html" class="navigation-list-link">SE-0040 Replacing Equal Signs with Colons For Attribute Arguments</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0041-conversion-protocol-conventions.html" class="navigation-list-link">SE-0041 Updating Protocol Naming Conventions for Conversions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0042-flatten-method-types.html" class="navigation-list-link">SE-0042 Flattening the function type of unapplied method references</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0043-declare-variables-in-case-labels-with-multiple-patterns.html" class="navigation-list-link">SE-0043 Declare variables in 'case' labels with multiple patterns </a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0044-import-as-member.html" class="navigation-list-link">SE-0044 Import as member</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0045-scan-takewhile-dropwhile.html" class="navigation-list-link">SE-0045 Add prefix(while:) and drop(while:) to the stdlib</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0046-first-label.html" class="navigation-list-link">SE-0046 Establish consistent label behavior across all parameters including first labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0047-nonvoid-warn.html" class="navigation-list-link">SE-0047 Defaulting non-Void functions so they warn on unused results</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0048-generic-typealias.html" class="navigation-list-link">SE-0048 Generic Type Aliases</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0049-noescape-autoclosure-type-attrs.html" class="navigation-list-link">SE-0049 Move @noescape and @autoclosure to be type attributes</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0050-floating-point-stride.html" class="navigation-list-link">SE-0050 Decoupling Floating Point Strides from Generic Implementations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0051-stride-semantics.html" class="navigation-list-link">SE-0051 Conventionalizing `stride` semantics</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0052-iterator-post-nil-guarantee.html" class="navigation-list-link">SE-0052 Change IteratorType post-nil guarantee</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0053-remove-let-from-function-parameters.html" class="navigation-list-link">SE-0053 Remove explicit use of `let` from Function Parameters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0054-abolish-iuo.html" class="navigation-list-link">SE-0054 Abolish `ImplicitlyUnwrappedOptional` type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0055-optional-unsafe-pointers.html" class="navigation-list-link">SE-0055 Make unsafe pointer nullability explicit using Optional</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0056-trailing-closures-in-guard.html" class="navigation-list-link">SE-0056 Allow trailing closures in `guard` conditions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0057-importing-objc-generics.html" class="navigation-list-link">SE-0057 Importing Objective-C Lightweight Generics</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0058-objectivecbridgeable.html" class="navigation-list-link">SE-0058 Allow Swift types to provide custom Objective-C representations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0059-updated-set-apis.html" class="navigation-list-link">SE-0059 Update API Naming Guidelines and Rewrite Set APIs Accordingly</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0060-defaulted-parameter-order.html" class="navigation-list-link">SE-0060 Enforcing order of defaulted parameters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0061-autoreleasepool-signature.html" class="navigation-list-link">SE-0061 Add Generic Result and Error Handling to autoreleasepool()</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0062-objc-keypaths.html" class="navigation-list-link">SE-0062 Referencing Objective-C key-paths</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0063-swiftpm-system-module-search-paths.html" class="navigation-list-link">SE-0063 SwiftPM System Module Search Paths</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0064-property-selectors.html" class="navigation-list-link">SE-0064 Referencing the Objective-C selector of property getters and setters</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0065-collections-move-indices.html" class="navigation-list-link">SE-0065 A New Model for Collections and Indices</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0066-standardize-function-type-syntax.html" class="navigation-list-link">SE-0066 Standardize function type argument syntax to require parentheses</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0067-floating-point-protocols.html" class="navigation-list-link">SE-0067 Enhanced Floating Point Protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0068-universal-self.html" class="navigation-list-link">SE-0068 Expanding Swift `Self` to class members and value types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0069-swift-mutability-for-foundation.html" class="navigation-list-link">SE-0069 Mutability and Foundation Value Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0070-optional-requirements.html" class="navigation-list-link">SE-0070 Make Optional Requirements Objective-C-only</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0071-member-keywords.html" class="navigation-list-link">SE-0071 Allow (most) keywords in member references</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0072-eliminate-implicit-bridging-conversions.html" class="navigation-list-link">SE-0072 Fully eliminate implicit bridging conversions from Swift</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0073-noescape-once.html" class="navigation-list-link">SE-0073 Marking closures as executing exactly once</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0074-binary-search.html" class="navigation-list-link">SE-0074 Implementation of Binary Search functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0075-import-test.html" class="navigation-list-link">SE-0075 Adding a Build Configuration Import Test</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0076-copying-to-unsafe-mutable-pointer-with-unsafe-pointer-source.html" class="navigation-list-link">SE-0076 Add overrides taking an UnsafePointer source to non-destructive copying methods on UnsafeMutablePointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0077-operator-precedence.html" class="navigation-list-link">SE-0077 Improved operator declarations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0078-rotate-algorithm.html" class="navigation-list-link">SE-0078 Implement a rotate algorithm, equivalent to std::rotate() in C++</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0079-upgrade-self-from-weak-to-strong.html" class="navigation-list-link">SE-0079 Allow using optional binding to upgrade `self` from a weak to strong reference</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0080-failable-numeric-initializers.html" class="navigation-list-link">SE-0080 Failable Numeric Conversion Initializers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0081-move-where-expression.html" class="navigation-list-link">SE-0081 Move `where` clause to end of declaration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0082-swiftpm-package-edit.html" class="navigation-list-link">SE-0082 Package Manager Editable Packages</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0083-remove-bridging-from-dynamic-casts.html" class="navigation-list-link">SE-0083 Remove bridging conversion behavior from dynamic casts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0084-trailing-commas.html" class="navigation-list-link">SE-0084 Allow trailing commas in parameter lists and tuples</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0085-package-manager-command-name.html" class="navigation-list-link">SE-0085 Package Manager Command Names</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0086-drop-foundation-ns.html" class="navigation-list-link">SE-0086 Drop NS Prefix in Swift Foundation</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0087-lazy-attribute.html" class="navigation-list-link">SE-0087 Rename `lazy` to `@lazy`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0088-libdispatch-for-swift3.html" class="navigation-list-link">SE-0088 Modernize libdispatch for Swift 3 naming conventions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0089-rename-string-reflection-init.html" class="navigation-list-link">SE-0089 Renaming `String.init<T>(_: T)`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0090-remove-dot-self.html" class="navigation-list-link">SE-0090 Remove `.self` and freely allow type references in expressions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0091-improving-operators-in-protocols.html" class="navigation-list-link">SE-0091 Improving operator requirements in protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0092-typealiases-in-protocols.html" class="navigation-list-link">SE-0092 Typealiases in protocols and protocol extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0093-slice-base.html" class="navigation-list-link">SE-0093 Adding a public `base` property to slices</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0094-sequence-function.html" class="navigation-list-link">SE-0094 Add sequence(first:next:) and sequence(state:next:) to the stdlib</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0095-any-as-existential.html" class="navigation-list-link">SE-0095 Replace `protocol<P1,P2>` syntax with `P1 & P2` syntax</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0096-dynamictype.html" class="navigation-list-link">SE-0096 Converting `dynamicType` from a property to an operator</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0097-negative-attributes.html" class="navigation-list-link">SE-0097 Normalizing naming for "negative" attributes</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0098-didset-capitalization.html" class="navigation-list-link">SE-0098 Lowercase `didSet` and `willSet` for more consistent keyword casing</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0099-conditionclauses.html" class="navigation-list-link">SE-0099 Restructuring Condition Clauses</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0100-add-sequence-based-init-and-merge-to-dictionary.html" class="navigation-list-link">SE-0100 Add sequence-based initializers and merge methods to Dictionary</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0101-standardizing-sizeof-naming.html" class="navigation-list-link">SE-0101 Reconfiguring `sizeof` and related functions into a unified `MemoryLayout` struct</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0102-noreturn-bottom-type.html" class="navigation-list-link">SE-0102 Remove `@noreturn` attribute and introduce an empty `Never` type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0103-make-noescape-default.html" class="navigation-list-link">SE-0103 Make non-escaping closures the default</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0104-improved-integers.html" class="navigation-list-link">SE-0104 Protocol-oriented integers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0105-remove-where-from-forin-loops.html" class="navigation-list-link">SE-0105 Removing Where Clauses from For-In Loops</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0106-rename-osx-to-macos.html" class="navigation-list-link">SE-0106 Add a `macOS` Alias for the `OSX` Platform Configuration Test</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0107-unsaferawpointer.html" class="navigation-list-link">SE-0107 UnsafeRawPointer API</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0108-remove-assoctype-inference.html" class="navigation-list-link">SE-0108 Remove associated type inference</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0109-remove-boolean.html" class="navigation-list-link">SE-0109 Remove the `Boolean` protocol </a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0110-distingish-single-tuple-arg.html" class="navigation-list-link">SE-0110 Distinguish between single-tuple and multiple-argument function types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0111-remove-arg-label-type-significance.html" class="navigation-list-link">SE-0111 Remove type system significance of function argument labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0112-nserror-bridging.html" class="navigation-list-link">SE-0112 Improved NSError Bridging</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0113-rounding-functions-on-floatingpoint.html" class="navigation-list-link">SE-0113 Add integral rounding functions to FloatingPoint</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0114-buffer-naming.html" class="navigation-list-link">SE-0114 Updating Buffer "Value" Names to "Header" Names</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0115-literal-syntax-protocols.html" class="navigation-list-link">SE-0115 Rename Literal Syntax Protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0116-id-as-any.html" class="navigation-list-link">SE-0116 Import Objective-C `id` as Swift `Any` type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0117-non-public-subclassable-by-default.html" class="navigation-list-link">SE-0117 Allow distinguishing between public access and public overridability</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0118-closure-parameter-names-and-labels.html" class="navigation-list-link">SE-0118 Closure Parameter Names and Labels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0119-extensions-access-modifiers.html" class="navigation-list-link">SE-0119 Remove access modifiers from extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0120-revise-partition-method.html" class="navigation-list-link">SE-0120 Revise `partition` Method Signature</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0121-remove-optional-comparison-operators.html" class="navigation-list-link">SE-0121 Remove `Optional` Comparison Operators</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0122-use-colons-for-subscript-type-declarations.html" class="navigation-list-link">SE-0122 Use colons for subscript declarations</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0123-disallow-value-to-optional-coercion-in-operator-arguments.html" class="navigation-list-link">SE-0123 Disallow coercion to optionals in operator arguments</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0124-bitpattern-label-for-int-initializer-objectidentfier.html" class="navigation-list-link">SE-0124 `Int.init(ObjectIdentifier)` and `UInt.init(ObjectIdentifier)` should have a `bitPattern:` label</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0125-remove-nonobjectivecbase.html" class="navigation-list-link">SE-0125 Remove `NonObjectiveCBase` and `isUniquelyReferenced`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0126-refactor-metatypes-repurpose-t-dot-self-and-mirror.html" class="navigation-list-link">SE-0126 Refactor Metatypes, repurpose `T.self` and `Mirror`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0127-cleaning-up-stdlib-ptr-buffer.html" class="navigation-list-link">SE-0127 Cleaning up stdlib Pointer and Buffer Routines</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0128-unicodescalar-failable-initializer.html" class="navigation-list-link">SE-0128 Change failable UnicodeScalar initializers to failable</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0129-package-manager-test-naming-conventions.html" class="navigation-list-link">SE-0129 Package Manager Test Naming Conventions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0130-string-initializers-cleanup.html" class="navigation-list-link">SE-0130 Replace repeating `Character` and `UnicodeScalar` forms of String.init</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0131-anyhashable.html" class="navigation-list-link">SE-0131 Add `AnyHashable` to the standard library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0132-sequence-end-ops.html" class="navigation-list-link">SE-0132 Rationalizing Sequence end-operation names</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0133-rename-flatten-to-joined.html" class="navigation-list-link">SE-0133 Rename `flatten()` to `joined()`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0134-rename-string-properties.html" class="navigation-list-link">SE-0134 Rename two UTF8-related properties on String</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0135-package-manager-support-for-differentiating-packages-by-swift-version.html" class="navigation-list-link">SE-0135 Package Manager Support for Differentiating Packages by Swift version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0136-memory-layout-of-values.html" class="navigation-list-link">SE-0136 Memory layout of values</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0137-avoiding-lock-in.html" class="navigation-list-link">SE-0137 Avoiding Lock-In to Legacy Protocol Designs</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0138-unsaferawbufferpointer.html" class="navigation-list-link">SE-0138 UnsafeRawBufferPointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0139-bridge-nsnumber-and-nsvalue.html" class="navigation-list-link">SE-0139 Bridge Numeric Types to `NSNumber` and Cocoa Structs to `NSValue`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0140-bridge-optional-to-nsnull.html" class="navigation-list-link">SE-0140 Warn when `Optional` converts to `Any`, and bridge `Optional` As Its Payload Or `NSNull`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0141-available-by-swift-version.html" class="navigation-list-link">SE-0141 Availability by Swift version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0142-associated-types-constraints.html" class="navigation-list-link">SE-0142 Permit where clauses to constrain associated types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0143-conditional-conformances.html" class="navigation-list-link">SE-0143 Conditional conformances</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0144-allow-single-dollar-sign-as-valid-identifier.html" class="navigation-list-link">SE-0144 Allow Single Dollar Sign as a Valid Identifier</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0145-package-manager-version-pinning.html" class="navigation-list-link">SE-0145 Package Manager Version Pinning</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0146-package-manager-product-definitions.html" class="navigation-list-link">SE-0146 Package Manager Product Definitions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0147-move-unsafe-initialize-from.html" class="navigation-list-link">SE-0147 Move UnsafeMutablePointer.initialize(from:) to UnsafeMutableBufferPointer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0148-generic-subscripts.html" class="navigation-list-link">SE-0148 Generic Subscripts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0149-package-manager-top-of-tree.html" class="navigation-list-link">SE-0149 Package Manager Support for Top of Tree development</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0150-package-manager-branch-support.html" class="navigation-list-link">SE-0150 Package Manager Support for branches</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0151-package-manager-swift-language-compatibility-version.html" class="navigation-list-link">SE-0151 Package Manager Swift Language Compatibility Version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0152-package-manager-tools-version.html" class="navigation-list-link">SE-0152 Package Manager Tools Version</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0153-compensate-for-the-inconsistency-of-nscopyings-behaviour.html" class="navigation-list-link">SE-0153 Compensate for the inconsistency of `@NSCopying`'s behaviour</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0154-dictionary-key-and-value-collections.html" class="navigation-list-link">SE-0154 Provide Custom Collections for Dictionary Keys and Values</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0155-normalize-enum-case-representation.html" class="navigation-list-link">SE-0155 Normalize Enum Case Representation</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0156-subclass-existentials.html" class="navigation-list-link">SE-0156 Class and Subtype existentials</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0157-recursive-protocol-constraints.html" class="navigation-list-link">SE-0157 Support recursive constraints on associated types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0158-package-manager-manifest-api-redesign.html" class="navigation-list-link">SE-0158 Package Manager Manifest API Redesign</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0159-fix-private-access-levels.html" class="navigation-list-link">SE-0159 Fix Private Access Levels</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0160-objc-inference.html" class="navigation-list-link">SE-0160 Limiting `@objc` inference</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0161-key-paths.html" class="navigation-list-link">SE-0161 Smart KeyPaths: Better Key-Value Coding for Swift</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0162-package-manager-custom-target-layouts.html" class="navigation-list-link">SE-0162 Package Manager Custom Target Layouts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0163-string-revision-1.html" class="navigation-list-link">SE-0163 String Revision: Collection Conformance, C Interop, Transcoding</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0164-remove-final-support-in-protocol-extensions.html" class="navigation-list-link">SE-0164 Remove final support in protocol extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0165-dict.html" class="navigation-list-link">SE-0165 Dictionary & Set Enhancements</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0166-swift-archival-serialization.html" class="navigation-list-link">SE-0166 Swift Archival & Serialization</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0167-swift-encoders.html" class="navigation-list-link">SE-0167 Swift Encoders</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0168-multi-line-string-literals.html" class="navigation-list-link">SE-0168 Multi-Line String Literals</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0169-improve-interaction-between-private-declarations-and-extensions.html" class="navigation-list-link">SE-0169 Improve Interaction Between `private` Declarations and Extensions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0170-nsnumber_bridge.html" class="navigation-list-link">SE-0170 NSNumber bridging and Numeric types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0171-reduce-with-inout.html" class="navigation-list-link">SE-0171 Reduce with `inout`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0172-one-sided-ranges.html" class="navigation-list-link">SE-0172 One-sided Ranges</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0173-swap-indices.html" class="navigation-list-link">SE-0173 Add `MutableCollection.swapAt(_:_:)`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0174-filter-range-replaceable.html" class="navigation-list-link">SE-0174 Change `filter` to return an associated type</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0175-package-manager-revised-dependency-resolution.html" class="navigation-list-link">SE-0175 Package Manager Revised Dependency Resolution</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0176-enforce-exclusive-access-to-memory.html" class="navigation-list-link">SE-0176 Enforce Exclusive Access to Memory</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0177-add-clamped-to-method.html" class="navigation-list-link">SE-0177 Add clamp(to:) to the stdlib</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0178-character-unicode-view.html" class="navigation-list-link">SE-0178 Add `unicodeScalars` property to `Character`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0179-swift-run-command.html" class="navigation-list-link">SE-0179 Swift `run` Command</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0180-string-index-overhaul.html" class="navigation-list-link">SE-0180 String Index Overhaul</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0181-package-manager-cpp-language-version.html" class="navigation-list-link">SE-0181 Package Manager C/C++ Language Standard Support</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0182-newline-escape-in-strings.html" class="navigation-list-link">SE-0182 String Newline Escaping</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0183-substring-affordances.html" class="navigation-list-link">SE-0183 Substring performance affordances</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0184-unsafe-pointers-add-missing.html" class="navigation-list-link">SE-0184 Unsafe[Mutable][Raw][Buffer]Pointer: add missing methods, adjust existing labels for clarity, and remove deallocation size</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0185-synthesize-equatable-hashable.html" class="navigation-list-link">SE-0185 Synthesizing `Equatable` and `Hashable` conformance</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0186-remove-ownership-keyword-support-in-protocols.html" class="navigation-list-link">SE-0186 Remove ownership keyword support in protocols</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0187-introduce-filtermap.html" class="navigation-list-link">SE-0187 Introduce Sequence.compactMap(_:)</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0188-stdlib-index-types-hashable.html" class="navigation-list-link">SE-0188 Make Standard Library Index Types Hashable</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0189-restrict-cross-module-struct-initializers.html" class="navigation-list-link">SE-0189 Restrict Cross-module Struct Initializers</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0190-target-environment-platform-condition.html" class="navigation-list-link">SE-0190 Target environment platform condition</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0191-eliminate-indexdistance.html" class="navigation-list-link">SE-0191 Eliminate `IndexDistance` from `Collection`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0192-non-exhaustive-enums.html" class="navigation-list-link">SE-0192 Handling Future Enum Cases</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0193-cross-module-inlining-and-specialization.html" class="navigation-list-link">SE-0193 Cross-module inlining and specialization</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0194-derived-collection-of-enum-cases.html" class="navigation-list-link">SE-0194 Derived Collection of Enum Cases</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0195-dynamic-member-lookup.html" class="navigation-list-link">SE-0195 Introduce User-defined "Dynamic Member Lookup" Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0196-diagnostic-directives.html" class="navigation-list-link">SE-0196 Compiler Diagnostic Directives</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0197-remove-where.html" class="navigation-list-link">SE-0197 Adding in-place `removeAll(where:)` to the Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0198-playground-quicklook-api-revamp.html" class="navigation-list-link">SE-0198 Playground QuickLook API Revamp #</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0199-bool-toggle.html" class="navigation-list-link">SE-0199 Adding `toggle` to `Bool`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0200-raw-string-escaping.html" class="navigation-list-link">SE-0200 Enhancing String Literals Delimiters to Support Raw Text</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0201-package-manager-local-dependencies.html" class="navigation-list-link">SE-0201 Package Manager Local Dependencies</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0202-random-unification.html" class="navigation-list-link">SE-0202 Random Unification</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0203-rename-sequence-elements-equal.html" class="navigation-list-link">SE-0203 Rename Sequence.elementsEqual</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0204-add-last-methods.html" class="navigation-list-link">SE-0204 Add `last(where:)` and `lastIndex(where:)` Methods</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0205-withUnsafePointer-for-lets.html" class="navigation-list-link">SE-0205 `withUnsafePointer(to:_:)` and `withUnsafeBytes(of:_:)` for immutable values</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0206-hashable-enhancements.html" class="navigation-list-link">SE-0206 Hashable Enhancements</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0207-containsOnly.html" class="navigation-list-link">SE-0207 Add an `allSatisfy` algorithm to `Sequence`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0208-package-manager-system-library-targets.html" class="navigation-list-link">SE-0208 Package Manager System Library Targets</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0209-package-manager-swift-lang-version-update.html" class="navigation-list-link">SE-0209 Package Manager Swift Language Version API Update</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0210-key-path-offset.html" class="navigation-list-link">SE-0210 Add an `offset(of:)` method to `MemoryLayout`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0211-unicode-scalar-properties.html" class="navigation-list-link">SE-0211 Add Unicode Properties to `Unicode.Scalar`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0212-compiler-version-directive.html" class="navigation-list-link">SE-0212 Compiler Version Directive</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0213-literal-init-via-coercion.html" class="navigation-list-link">SE-0213 Literal initialization via coercion</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0214-DictionaryLiteral.html" class="navigation-list-link">SE-0214 Renaming the `DictionaryLiteral` type to `KeyValuePairs`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0215-conform-never-to-hashable-and-equatable.html" class="navigation-list-link">SE-0215 Conform `Never` to `Equatable` and `Hashable`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0216-dynamic-callable.html" class="navigation-list-link">SE-0216 Introduce user-defined dynamically "callable" types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0217-bangbang.html" class="navigation-list-link">SE-0217 Introducing the `!!` "Unwrap or Die" operator to the Swift Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0218-introduce-compact-map-values.html" class="navigation-list-link">SE-0218 Introduce `compactMapValues` to Dictionary</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0219-package-manager-dependency-mirroring.html" class="navigation-list-link">SE-0219 Package Manager Dependency Mirroring</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0220-count-where.html" class="navigation-list-link">SE-0220 `count(where:)`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0221-character-properties.html" class="navigation-list-link">SE-0221 Character Properties</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0222-lazy-compactmap-sequence.html" class="navigation-list-link">SE-0222 Lazy CompactMap Sequence</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0223-array-uninitialized-initializer.html" class="navigation-list-link">SE-0223 Accessing an Array's Uninitialized Buffer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0224-ifswift-lessthan-operator.html" class="navigation-list-link">SE-0224 Support 'less than' operator in compilation conditions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0225-binaryinteger-iseven-isodd-ismultiple.html" class="navigation-list-link">SE-0225 Adding `isMultiple` to `BinaryInteger`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0226-package-manager-target-based-dep-resolution.html" class="navigation-list-link">SE-0226 Package Manager Target Based Dependency Resolution</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0227-identity-keypath.html" class="navigation-list-link">SE-0227 Identity key path</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0228-fix-expressiblebystringinterpolation.html" class="navigation-list-link">SE-0228 Fix `ExpressibleByStringInterpolation`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0229-simd.html" class="navigation-list-link">SE-0229 SIMD Vectors</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0230-flatten-optional-try.html" class="navigation-list-link">SE-0230 Flatten nested optionals resulting from 'try?'</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0231-optional-iteration.html" class="navigation-list-link">SE-0231 Optional Iteration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0232-remove-customization-points.html" class="navigation-list-link">SE-0232 Remove Some Customization Points from the Standard Library's `Collection` Hierarchy</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0233-additive-arithmetic-protocol.html" class="navigation-list-link">SE-0233 Make `Numeric` Refine a new `AdditiveArithmetic` Protocol</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0234-remove-sequence-subsequence.html" class="navigation-list-link">SE-0234 Remove `Sequence.SubSequence`</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0235-add-result.html" class="navigation-list-link">SE-0235 Add Result to the Standard Library</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0236-package-manager-platform-deployment-settings.html" class="navigation-list-link">SE-0236 Package Manager Platform Deployment Settings</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0237-contiguous-collection.html" class="navigation-list-link">SE-0237 Introduce `withContiguous{Mutable}StorageIfAvailable` methods</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0238-package-manager-build-settings.html" class="navigation-list-link">SE-0238 Package Manager Target Specific Build Settings</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0239-codable-range.html" class="navigation-list-link">SE-0239 Add Codable conformance to Range types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0240-ordered-collection-diffing.html" class="navigation-list-link">SE-0240 Ordered Collection Diffing</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0241-string-index-explicit-encoding-offset.html" class="navigation-list-link">SE-0241 Deprecate String Index Encoded Offsets</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0242-default-values-memberwise.html" class="navigation-list-link">SE-0242 Synthesize default values for the memberwise initializer</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0243-codepoint-and-character-literals.html" class="navigation-list-link">SE-0243 Integer-convertible character literals</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0244-opaque-result-types.html" class="navigation-list-link">SE-0244 Opaque Result Types</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0245-array-uninitialized-initializer.html" class="navigation-list-link">SE-0245 Add an Array Initializer with Access to Uninitialized Storage</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0246-mathable.html" class="navigation-list-link">SE-0246 Generic Math(s) Functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0247-contiguous-strings.html" class="navigation-list-link">SE-0247 Contiguous Strings</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0248-string-gaps-missing-apis.html" class="navigation-list-link">SE-0248 String Gaps and Missing APIs</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0249-key-path-literal-function-expressions.html" class="navigation-list-link">SE-0249 Key Path Expressions as Functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0250-swift-style-guide-and-formatter.html" class="navigation-list-link">SE-0250 Swift Code Style Guidelines and Formatter</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0251-simd-additions.html" class="navigation-list-link">SE-0251 SIMD additions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0252-keypath-dynamic-member-lookup.html" class="navigation-list-link">SE-0252 Key Path Member Lookup</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0253-callable.html" class="navigation-list-link">SE-0253 Introduce callables </a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0254-static-subscripts.html" class="navigation-list-link">SE-0254 Static and class subscripts</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0255-omit-return.html" class="navigation-list-link">SE-0255 Implicit returns from single-expression functions</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0256-contiguous-collection.html" class="navigation-list-link">SE-0256 Introduce `{Mutable}ContiguousCollection` protocol</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-0257-elide-comma.html" class="navigation-list-link">SE-0257 Eliding commas from multiline expression lists</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/2019-08-26-xxxx-synthesize-computed-property.html" class="navigation-list-link"> Feature name</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Swift Evolution List" aria-label="Search Swift Evolution List" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="//github.com/pondok-programmer/swift-evolution-jekyll">Swift Evolution List</a></li> </ul> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 id="property-behaviors"> <a href="#property-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Property Behaviors </h1> <ul> <li>Proposal: <a href="0030-property-behavior-decls.md">SE-0030</a></li> <li>Author: <a href="https://github.com/jckarter">Joe Groff</a></li> <li>Review Manager: <a href="https://github.com/DougGregor">Doug Gregor</a></li> <li>Status: <strong>Deferred</strong></li> <li>Decision Notes: <a href="https://lists.swift.org/pipermail/swift-evolution-announce/2016-February/000047.html">Rationale</a></li> </ul> <h2 id="introduction"> <a href="#introduction" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Introduction </h2> <p>There are property implementation patterns that come up repeatedly. Rather than hardcode a fixed set of patterns into the compiler, we should provide a general “property behavior” mechanism to allow these patterns to be defined as libraries.</p> <p><a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20151214/003148.html">Swift Evolution Discussion</a><br /> <a href="https://lists.swift.org/pipermail/swift-evolution/Week-of-Mon-20160208/009603.html">Review</a></p> <h2 id="motivation"> <a href="#motivation" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Motivation </h2> <p>We’ve tried to accommodate several important patterns for properties with targeted language support, but this support has been narrow in scope and utility. For instance, Swift 1 and 2 provide <code class="highlighter-rouge">lazy</code> properties as a primitive language feature, since lazy initialization is common and is often necessary to avoid having properties be exposed as <code class="highlighter-rouge">Optional</code>. Without this language support, it takes a lot of boilerplate to get the same effect:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">Foo</span> <span class="p">{</span>
  <span class="c1">// lazy var foo = 1738</span>
  <span class="kd">private</span> <span class="k">var</span> <span class="nv">_foo</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span>
  <span class="k">var</span> <span class="nv">foo</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span>
      <span class="k">if</span> <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">_foo</span> <span class="p">{</span> <span class="k">return</span> <span class="n">value</span> <span class="p">}</span>
      <span class="k">let</span> <span class="nv">initialValue</span> <span class="o">=</span> <span class="mi">1738</span>
      <span class="n">_foo</span> <span class="o">=</span> <span class="n">initialValue</span>
      <span class="k">return</span> <span class="n">initialValue</span>
    <span class="p">}</span>
    <span class="k">set</span> <span class="p">{</span>
      <span class="n">_foo</span> <span class="o">=</span> <span class="n">newValue</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Building <code class="highlighter-rouge">lazy</code> into the language has several disadvantages. It makes the language and compiler more complex and less orthogonal. It’s also inflexible; there are many variations on lazy initialization that make sense, but we wouldn’t want to hardcode language support for all of them. For instance, some applications may want the lazy initialization to be synchronized, but <code class="highlighter-rouge">lazy</code> only provides single-threaded initialization. The standard implementation of <code class="highlighter-rouge">lazy</code> is also problematic for value types. A <code class="highlighter-rouge">lazy</code> getter must be <code class="highlighter-rouge">mutating</code>, which means it can’t be accessed from an immutable value. Inline storage is also suboptimal for many memoization tasks, since the cache cannot be reused across copies of the value. A value-oriented memoized property implementation might look very different, using a class instance to store the cached value out-of-line in order to avoid mutation of the value itself.</p> <p>There are important property patterns outside of lazy initialization. It often makes sense to have “delayed”, once-assignable-then-immutable properties to support multi-phase initialization:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">Foo</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">immediatelyInitialized</span> <span class="o">=</span> <span class="s">"foo"</span>
  <span class="k">var</span> <span class="nv">_initializedLater</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>

  <span class="c1">// We want initializedLater to present like a non-optional 'let' to user code;</span>
  <span class="c1">// it can only be assigned once, and can't be accessed before being assigned.</span>
  <span class="k">var</span> <span class="nv">initializedLater</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_initializedLater</span><span class="o">!</span> <span class="p">}</span>
    <span class="k">set</span> <span class="p">{</span>
      <span class="nf">assert</span><span class="p">(</span><span class="n">_initializedLater</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span>
      <span class="n">_initializedLater</span> <span class="o">=</span> <span class="n">newValue</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div> <p>Implicitly-unwrapped optionals allow this in a pinch, but give up a lot of safety compared to a non-optional ‘let’. Using IUO for multi-phase initialization gives up both immutability and nil-safety.</p> <p>We also have other application-specific property features like <code class="highlighter-rouge">didSet</code>/<code class="highlighter-rouge">willSet</code> that add language complexity for limited functionality. Beyond what we’ve baked into the language already, there’s a seemingly endless set of common property behaviors, including synchronized access, copying, and various kinds of proxying, all begging for language attention to eliminate their boilerplate.</p> <h2 id="proposed-solution"> <a href="#proposed-solution" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Proposed solution </h2> <p>I suggest we allow for <strong>property behaviors</strong> to be implemented within the language. A <code class="highlighter-rouge">var</code> declaration can specify its <strong>behaviors</strong> in square brackets after the keyword:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="p">[</span><span class="kd">lazy</span><span class="p">]</span> <span class="n">foo</span> <span class="o">=</span> <span class="mi">1738</span>
</code></pre></div></div> <p>which implements the property <code class="highlighter-rouge">foo</code> in a way described by the <strong>property behavior declaration</strong> for <code class="highlighter-rouge">lazy</code>:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="kd">lazy</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>
  <span class="n">initialValue</span>

  <span class="k">mutating</span> <span class="k">get</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">value</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">value</span>
    <span class="p">}</span>
    <span class="k">let</span> <span class="nv">initial</span> <span class="o">=</span> <span class="n">initialValue</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">initial</span>
    <span class="k">return</span> <span class="n">initial</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Property behaviors can control the storage, initialization, and access of affected properties, obviating the need for special language support for <code class="highlighter-rouge">lazy</code>, observers, and other special-case property features.</p> <h2 id="examples"> <a href="#examples" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Examples </h2> <p>Before describing the detailed design, I’ll run through some examples of potential applications for behaviors.</p> <h3 id="lazy"> <a href="#lazy" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Lazy </h3> <p>The current <code class="highlighter-rouge">lazy</code> property feature can be reimplemented as a property behavior.</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Property behaviors are declared using the `var behavior` keyword cluster.</span>
<span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="kd">lazy</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="c1">// Behaviors can declare storage that backs the property.</span>
  <span class="kd">private</span> <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span><span class="p">?</span>

  <span class="c1">// Behaviors can bind the property's initializer expression with an</span>
  <span class="c1">// `initialValue` property declaration.</span>
  <span class="n">initialValue</span>

  <span class="c1">// Behaviors can declare initialization logic for the storage.</span>
  <span class="c1">// (Stored properties can also be initialized in-line.)</span>
  <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">value</span> <span class="o">=</span> <span class="kc">nil</span>
  <span class="p">}</span>

  <span class="c1">// Inline initializers are also supported, so `var value: Value? = nil`</span>
  <span class="c1">// would work equivalently.</span>

  <span class="c1">// Behaviors can declare accessors that implement the property.</span>
  <span class="k">mutating</span> <span class="k">get</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">value</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">value</span>
    <span class="p">}</span>
    <span class="k">let</span> <span class="nv">initial</span> <span class="o">=</span> <span class="n">initialValue</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">initial</span>
    <span class="k">return</span> <span class="n">initial</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Properties declared with the <code class="highlighter-rouge">lazy</code> behavior are backed by the <code class="highlighter-rouge">Optional</code>-typed storage and accessors from the behavior:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="p">[</span><span class="kd">lazy</span><span class="p">]</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1738</span> <span class="c1">// Allocates an Int? behind the scenes, inited to nil</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">// Invokes the `lazy` getter, initializing the property</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">679</span> <span class="c1">// Invokes the `lazy` setter</span>
</code></pre></div></div> <h3 id="delayed-initialization"> <a href="#delayed-initialization" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Delayed Initialization </h3> <p>A property behavior can model “delayed” initialization behavior, where the DI rules for properties are enforced dynamically rather than at compile time. This can avoid the need for implicitly-unwrapped optionals in multi-phase initialization. We can implement both a mutable variant, which allows for reassignment like a <code class="highlighter-rouge">var</code>:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="n">delayedMutable</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="kd">private</span> <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nf">fatalError</span><span class="p">(</span><span class="s">"property accessed before being initialized"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">value</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>and an immutable variant, which only allows a single initialization like a <code class="highlighter-rouge">let</code>:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="n">delayedImmutable</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="kd">private</span> <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nf">fatalError</span><span class="p">(</span><span class="s">"property accessed before being initialized"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">value</span>
  <span class="p">}</span>

  <span class="c1">// Perform an initialization, trapping if the</span>
  <span class="c1">// value is already initialized.</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">_</span> <span class="o">=</span> <span class="n">value</span> <span class="p">{</span>
      <span class="nf">fatalError</span><span class="p">(</span><span class="s">"property initialized twice"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">initialValue</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>This enables multi-phase initialization, like this:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">Foo</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="p">[</span><span class="n">delayedImmutable</span><span class="p">]</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span>

  <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// We don't know "x" yet, and we don't have to set it</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">initializeX</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="c1">// Will crash if 'self.x' is already initialized</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">getX</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">x</span> <span class="c1">// Will crash if 'self.x' wasn't initialized</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="property-observers"> <a href="#property-observers" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Property Observers </h3> <p>A property behavior can also approximate the built-in behavior of <code class="highlighter-rouge">didSet</code>/<code class="highlighter-rouge">willSet</code> observers, by declaring support for custom accessors:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="n">observed</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="k">var</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">initialValue</span>

  <span class="c1">// A behavior can declare accessor requirements, the implementations of</span>
  <span class="c1">// which must be provided by property declarations using the behavior.</span>
  <span class="c1">// The behavior may provide a default implementation of the accessors, in</span>
  <span class="c1">// order to make them optional.</span>

  <span class="c1">// The willSet accessor, invoked before the property is updated. The</span>
  <span class="c1">// default does nothing.</span>
  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">willSet</span><span class="p">(</span><span class="nv">newValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

  <span class="c1">// The didSet accessor, invoked before the property is updated. The</span>
  <span class="c1">// default does nothing.</span>
  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">didSet</span><span class="p">(</span><span class="nv">oldValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">value</span>
  <span class="p">}</span>

  <span class="k">set</span> <span class="p">{</span>
    <span class="nf">willSet</span><span class="p">(</span><span class="n">newValue</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">oldValue</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
    <span class="nf">didSet</span><span class="p">(</span><span class="n">oldValue</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>A common complaint with <code class="highlighter-rouge">didSet</code>/<code class="highlighter-rouge">willSet</code> is that the observers fire on <em>every</em> write, not only ones that cause a real change. A behavior that supports a <code class="highlighter-rouge">didChange</code> accessor, which only gets invoked if the property value really changed to a value not equal to the old value, can be implemented as a new behavior:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="n">changeObserved</span><span class="o">&lt;</span><span class="kt">Value</span><span class="p">:</span> <span class="kt">Equatable</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="k">var</span> <span class="nv">value</span> <span class="o">=</span> <span class="n">initialValue</span>

  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">didChange</span><span class="p">(</span><span class="nv">oldValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">value</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">oldValue</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
    <span class="k">if</span> <span class="n">oldValue</span> <span class="o">!=</span> <span class="n">newValue</span> <span class="p">{</span>
      <span class="nf">didChange</span><span class="p">(</span><span class="n">oldValue</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>For example:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="p">[</span><span class="n">changeObserved</span><span class="p">]</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">{</span>
  <span class="n">didChange</span> <span class="p">{</span> <span class="nf">print</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">oldValue</span><span class="se">)</span><span class="s"> =&gt; </span><span class="se">\(</span><span class="n">x</span><span class="se">)</span><span class="s">"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// Prints nothing</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">// Prints 1 =&gt; 2</span>
</code></pre></div></div> <p>(Note that, like <code class="highlighter-rouge">didSet</code>/<code class="highlighter-rouge">willSet</code> today, neither behavior implementation will observe changes through class references that mutate a referenced class instance without changing the reference itself. Also, as currently proposed, behaviors would force the property to be initialized in-line, which is not acceptable for instance properties. That’s a limitation that can be lifted by future extensions.)</p> <h3 id="synchronized-property-access"> <a href="#synchronized-property-access" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Synchronized Property Access </h3> <p>Objective-C supports <code class="highlighter-rouge">atomic</code> properties, which take a lock on <code class="highlighter-rouge">get</code> and <code class="highlighter-rouge">set</code> to synchronize accesses to a property. This is occasionally useful, and it can be brought to Swift as a behavior. The real implementation of <code class="highlighter-rouge">atomic</code> properties in ObjC uses a global bank of locks, but for illustrative purposes (and to demonstrate referring to <code class="highlighter-rouge">self</code>) I’ll use a per-object lock instead:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// A class that owns a mutex that can be used to synchronize access to its</span>
<span class="c1">// properties.</span>
<span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">Synchronizable</span><span class="p">:</span> <span class="kd">class</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="n">withLock</span><span class="o">&lt;</span><span class="kt">R</span><span class="o">&gt;</span><span class="p">(</span><span class="kd">@noescape</span> <span class="nv">body</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">R</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">R</span>
<span class="p">}</span>

<span class="c1">// Behaviors can refer to a property's containing type using</span>
<span class="c1">// the implicit `Self` generic parameter. Constraints can be</span>
<span class="c1">// applied using a 'where' clause, like in an extension.</span>
<span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="n">synchronized</span><span class="o">&lt;</span><span class="kt">Value</span> <span class="k">where</span> <span class="k">Self</span><span class="p">:</span> <span class="kt">Synchronizable</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span> <span class="o">=</span> <span class="n">initialValue</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="n">withLock</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">value</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="k">self</span><span class="o">.</span><span class="n">withLock</span> <span class="p">{</span>
      <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="nscopying"> <a href="#nscopying" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> <code class="highlighter-rouge">NSCopying</code> </h3> <p>Many Cocoa classes implement value-like objects that require explicit copying. Swift currently provides an <code class="highlighter-rouge">@NSCopying</code> attribute for properties to give them behavior like Objective-C’s <code class="highlighter-rouge">@property(copy)</code>, invoking the <code class="highlighter-rouge">copy</code> method on new objects when the property is set. We can turn this into a behavior:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="k">var</span> <span class="nv">behavior</span> <span class="n">copying</span><span class="o">&lt;</span><span class="kt">Value</span><span class="p">:</span> <span class="kt">NSCopying</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="c1">// Copy the value on initialization.</span>
  <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span> <span class="o">=</span> <span class="n">initialValue</span><span class="o">.</span><span class="nf">copy</span><span class="p">()</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">value</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="c1">// Copy the value on reassignment.</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span><span class="o">.</span><span class="nf">copy</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>This is a small sampling of the possibilities of behaviors. Let’s look at the proposed design in detail:</p> <h2 id="detailed-design"> <a href="#detailed-design" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Detailed design </h2> <h3 id="property-behavior-declarations"> <a href="#property-behavior-declarations" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Property behavior declarations </h3> <p>A <strong>property behavior declaration</strong> is introduced by the <code class="highlighter-rouge">var behavior</code> contextual keyword cluster. The declaration is designed to resemble the syntax of a property using the behavior:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>property-behavior-decl ::=
  attribute* decl-modifier*
  'var' 'behavior' identifier         // behavior name
  generic-signature?
  ':' type
  '{'
    property-behavior-member-decl*
  '}'
</code></pre></div></div> <p>Inside the behavior declaration, standard initializer, property, method, and nested type declarations are allowed, as are <strong>core accessor</strong> declarations —<code class="highlighter-rouge">get</code> and <code class="highlighter-rouge">set</code>. <strong>Accessor requirement declarations</strong> and <strong>initial value requirement declarations</strong> are also recognized contextually within the declaration:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>property-behavior-member-decl ::= decl
property-behavior-member-decl ::= accessor-decl // get, set
property-behavior-member-decl ::= accessor-requirement-decl
property-behavior-member-decl ::= initial-value-requirement-decl
</code></pre></div></div> <h3 id="bindings-within-behavior-declarations"> <a href="#bindings-within-behavior-declarations" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Bindings within Behavior Declarations </h3> <p>Inside a behavior declaration, <code class="highlighter-rouge">self</code> is implicitly bound to the value that contains the property instantiated using this behavior. For a freestanding property at global or local scope, this will be the empty tuple <code class="highlighter-rouge">()</code>, and for a static or class property, this will be the metatype. Within the behavior declaration, the type of <code class="highlighter-rouge">self</code> is abstract and represented by the implicit generic type parameter <code class="highlighter-rouge">Self</code>. Constraints can be placed on <code class="highlighter-rouge">Self</code> in the generic signature of the behavior, to make protocol members available on <code class="highlighter-rouge">self</code>:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">Fungible</span> <span class="p">{</span>
  <span class="kd">typealias</span> <span class="kt">Fungus</span>
  <span class="kd">func</span> <span class="nf">funge</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Fungus</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">behavior</span> <span class="n">runcible</span><span class="o">&lt;</span><span class="kt">Value</span> <span class="k">where</span> <span class="k">Self</span><span class="p">:</span> <span class="kt">Fungible</span><span class="p">,</span> <span class="k">Self</span><span class="o">.</span><span class="kt">Fungus</span> <span class="o">==</span> <span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="nf">funge</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Lookup within <code class="highlighter-rouge">self</code> is <em>not</em> implicit within behaviors and must always be explicit, since unqualified lookup refers to the behavior’s own members. <code class="highlighter-rouge">self</code> is immutable except in <code class="highlighter-rouge">mutating</code> methods, where it is considered an <code class="highlighter-rouge">inout</code> parameter unless the <code class="highlighter-rouge">Self</code> type has a class constraint. <code class="highlighter-rouge">self</code> cannot be accessed within inline initializers of the behavior’s storage or in <code class="highlighter-rouge">init</code> declarations, since these may run during the container’s own initialization phase.</p> <p>Definitions within behaviors can refer to other members of the behavior by unqualified lookup, or if disambiguation is necessary, by qualified lookup on the behavior’s name (since <code class="highlighter-rouge">self</code> is already taken to mean the containing value):</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">foo</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span>

  <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1738</span>
  <span class="p">}</span>

  <span class="k">mutating</span> <span class="kd">func</span> <span class="nf">update</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">foo</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="c1">// Disambiguate reference to behavior storage</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>If the behavior includes <em>accessor requirement declarations</em>, then the declared accessor names are bound as functions with labeled arguments:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">fakeComputed</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">accessor</span> <span class="nf">get</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Value</span>
  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">set</span><span class="p">(</span><span class="nv">newValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nf">get</span><span class="p">()</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="nf">set</span><span class="p">(</span><span class="nv">newValue</span><span class="p">:</span> <span class="n">newValue</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Note that the behavior’s own <em>core accessor</em> implementations <code class="highlighter-rouge">get { ... }</code> and <code class="highlighter-rouge">set { ... }</code> are <em>not</em> referenceable this way.</p> <p>If the behavior includes an <em>initial value requirement declaration</em>, then the identifier <code class="highlighter-rouge">initialValue</code> is bound as a get-only computed property that evaluates the initial value expression for the property</p> <h3 id="properties-and-methods-in-behaviors"> <a href="#properties-and-methods-in-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Properties and Methods in Behaviors </h3> <p>Behaviors may include property and method declarations. Any storage produced by behavior properties is expanded into the containing scope of a property using the behavior.</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">runcible</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">let</span> <span class="nv">y</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>
  <span class="o">...</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="p">[</span><span class="n">runcible</span><span class="p">]</span> <span class="nv">a</span><span class="p">:</span> <span class="kt">Int</span>

<span class="c1">// expands to:</span>

<span class="kd">var</span> <span class="err">`</span><span class="n">a</span><span class="o">.</span><span class="p">[</span><span class="n">runcible</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="err">`</span><span class="p">:</span> <span class="kt">Int</span>
<span class="kd">let</span> <span class="err">`</span><span class="n">a</span><span class="o">.</span><span class="p">[</span><span class="n">runcible</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="err">`</span><span class="p">:</span> <span class="kt">String</span>
<span class="k">var</span> <span class="nv">a</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</code></pre></div></div> <p>For public behaviors, this is inherently <em>fragile</em>, so adding or removing storage is a breaking change. Resilience can be achieved by using a resilient type as storage. The instantiated properties must also be of types that are visible to potential users of the behavior, meaning that public behaviors must use storage with types that are either public or internal-with-availability, similar to the restrictions on inlineable functions.</p> <p>Method and computed property implementations have only immutable access to <code class="highlighter-rouge">self</code> and their storage by default, unless they are <code class="highlighter-rouge">mutating</code>. (As with computed properties, setters are <code class="highlighter-rouge">mutating</code> by default unless explicitly marked <code class="highlighter-rouge">nonmutating</code>).</p> <h3 id="init-in-behaviors"> <a href="#init-in-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> <code class="highlighter-rouge">init</code> in Behaviors </h3> <p>The storage of a behavior must be initialized, either by inline initialization, or by an <code class="highlighter-rouge">init</code> declaration within the initializer:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">inlineInitialized</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">// initialized inline</span>
  <span class="o">...</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">behavior</span> <span class="n">initInitialized</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span>

  <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Behaviors can contain at most one <code class="highlighter-rouge">init</code> declaration, which must take no parameters. This <code class="highlighter-rouge">init</code> declaration cannot take a visibility modifier; it is always as visible as the behavior itself. Neither inline initializers nor <code class="highlighter-rouge">init</code> declaration bodies may reference <code class="highlighter-rouge">self</code>, since they will be executed during the initialization of a property’s containing value.</p> <h3 id="initial-value-requirement-declaration"> <a href="#initial-value-requirement-declaration" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Initial Value Requirement Declaration </h3> <p>An <em>initial value requirement declaration</em> specifies that a behavior requires any property declared using the behavior to be declared with an initial value expression.</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">initial</span><span class="o">-</span><span class="n">value</span><span class="o">-</span><span class="n">requirement</span><span class="o">-</span><span class="nv">decl</span> <span class="p">::</span><span class="o">=</span> <span class="err">'</span><span class="n">initialValue</span><span class="err">'</span>
</code></pre></div></div> <p>The initial value expression from the property declaration is coerced to the property’s type and bound to the <code class="highlighter-rouge">initialValue</code> identifier in the scope of the behavior. Loading from <code class="highlighter-rouge">initialValue</code> behaves like a get-only computed property, evaluating the expression every time it is loaded:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">evalTwice</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="k">get</span> <span class="p">{</span>
    <span class="c1">// Evaluate the initial value twice, for whatever reason.</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">initialValue</span>
    <span class="k">return</span> <span class="n">initialValue</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">evalTwice</span><span class="p">]</span> <span class="nv">test</span><span class="p">:</span> <span class="p">()</span> <span class="o">=</span> <span class="nf">print</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span>

<span class="c1">// Prints "test" twice</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">evalTwice</span>
</code></pre></div></div> <p>A property declared with a behavior must have an initial value expression if and only if the behavior has an initial value requirement.</p> <h3 id="accessor-requirement-declarations"> <a href="#accessor-requirement-declarations" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Accessor Requirement Declarations </h3> <p>An <em>accessor requirement declaration</em> specifies that a behavior requires any property declared using the behavior to provide an accessor implementation. An accessor requirement declaration is introduced by the contextual <code class="highlighter-rouge">accessor</code> keyword:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accessor</span><span class="o">-</span><span class="n">requirement</span><span class="o">-</span><span class="nv">decl</span> <span class="p">::</span><span class="o">=</span>
  <span class="n">attribute</span><span class="o">*</span> <span class="n">decl</span><span class="o">-</span><span class="n">modifier</span><span class="o">*</span>
  <span class="err">'</span><span class="n">accessor</span><span class="err">'</span> <span class="n">identifier</span> <span class="n">function</span><span class="o">-</span><span class="n">signature</span> <span class="n">function</span><span class="o">-</span><span class="n">body</span><span class="p">?</span>
</code></pre></div></div> <p>An accessor requirement declaration looks like, and serves a similar role to, a function requirement declaration in a protocol. A property using the behavior must supply an implementation for each of its accessor requirements that don’t have a default implementation. The accessor names (with labeled arguments) are bound as functions within the behavior declaration:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Reinvent computed properties</span>
<span class="k">var</span> <span class="nv">behavior</span> <span class="n">foobar</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">accessor</span> <span class="nf">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Value</span>
  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">bar</span><span class="p">(</span><span class="nv">bas</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span>

  <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span> <span class="nf">bar</span><span class="p">(</span><span class="nv">bas</span><span class="p">:</span> <span class="n">newValue</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">foobar</span><span class="p">]</span> <span class="nv">foo</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="n">foo</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span>
  <span class="p">}</span>
  <span class="n">bar</span> <span class="p">{</span>
    <span class="c1">// Parameter gets the name 'bas' from the accessor requirement</span>
    <span class="c1">// by default, as with built-in accessors today.</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">bas</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">foobar</span><span class="p">]</span> <span class="nv">bar</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="n">foo</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span>
  <span class="p">}</span>
  <span class="nf">bar</span><span class="p">(</span><span class="n">myNewValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Parameter name can be overridden as well</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">myNewValue</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Accessor requirements can be made optional by specifying a default implementation:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Reinvent property observers</span>
<span class="k">var</span> <span class="nv">behavior</span> <span class="n">observed</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="c1">// Requirements</span>

  <span class="n">initialValue</span>
  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">willSet</span><span class="p">(</span><span class="nv">newValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do nothing by default</span>
  <span class="p">}</span>
  <span class="k">mutating</span> <span class="n">accessor</span> <span class="nf">didSet</span><span class="p">(</span><span class="nv">oldValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do nothing by default</span>
  <span class="p">}</span>

  <span class="c1">// Implementation</span>

  <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">initialValue</span>
  <span class="p">}</span>
  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">value</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="nf">willSet</span><span class="p">(</span><span class="nv">newValue</span><span class="p">:</span> <span class="n">newValue</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">oldValue</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">newValue</span>
    <span class="nf">didSet</span><span class="p">(</span><span class="nv">oldValue</span><span class="p">:</span> <span class="n">oldValue</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Accessor requirements cannot take visibility modifiers; they are always as visible as the behavior itself.</p> <p>Like methods, accessors are not allowed to mutate the storage of the behavior or <code class="highlighter-rouge">self</code> unless declared <code class="highlighter-rouge">mutating</code>. Mutating accessors can only be invoked by the behavior from other <code class="highlighter-rouge">mutating</code> contexts.</p> <h3 id="core-accessor-declarations"> <a href="#core-accessor-declarations" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Core Accessor Declarations </h3> <p>The behavior implements the property by defining its <em>core accessors</em>, <code class="highlighter-rouge">get</code> and optionally <code class="highlighter-rouge">set</code>. If a behavior only provides a getter, it produces read-only properties; if it provides both a getter and setter, it produces mutable properties (though properties that instantiate the behavior may still control the visibility of their setters). It is an error if a behavior declaration does not provide at least a getter.</p> <h3 id="using-behaviors-in-property-declarations"> <a href="#using-behaviors-in-property-declarations" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Using Behaviors in Property Declarations </h3> <p>Property declarations gain the ability to instantiate behavior, with arbitrary accessors:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>property-decl ::= attribute* decl-modifier* core-property-decl
core-property-decl ::=
  ('var' | 'let') behavior? pattern-binding
  ((',' pattern-binding)+ | accessors)?
behavior ::= '[' visibility? decl-ref ']'
pattern-binding ::= var-pattern (':' type)? inline-initializer?
inline-initializer ::= '=' expr
accessors ::= '{' accessor+ '}' | brace-stmt // see notes about disambiguation
accessor ::= decl-modifier* decl-ref accessor-args? brace-stmt
accessor-args ::= '(' identifier (',' identifier)* ')'
</code></pre></div></div> <p>For example:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">var</span> <span class="p">[</span><span class="n">behavior</span><span class="p">]</span> <span class="nv">prop</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="n">accessor1</span> <span class="p">{</span> <span class="nf">body</span><span class="p">()</span> <span class="p">}</span>
  <span class="n">behavior</span><span class="o">.</span><span class="nf">accessor2</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span> <span class="nf">body</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>If multiple properties are declared in the same declaration, the behavior apply to every declared property. <code class="highlighter-rouge">let</code> properties cannot yet use behaviors.</p> <p>If the behavior requires accessors, the implementations for those accessors are taken from the property’s accessor declarations, matching by name. To support future composition of behaviors, the accessor definitions can use qualified names <code class="highlighter-rouge">behavior.accessor</code>. If an accessor requirement takes parameters, but the definition in for the property does not explicitly name parameters, the parameter labels from the behavior’s accessor requirement declaration are implicitly bound by default.</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">foo</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">accessor</span> <span class="nf">bar</span><span class="p">(</span><span class="nv">arg</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>
  <span class="o">...</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">foo</span><span class="p">]</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="n">bar</span> <span class="p">{</span> <span class="nf">print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// `arg` implicitly bound</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">foo</span><span class="p">]</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="nf">bar</span><span class="p">(</span><span class="n">myArg</span><span class="p">)</span> <span class="p">{</span> <span class="nf">print</span><span class="p">(</span><span class="n">myArg</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// `arg` explicitly bound to `myArg`</span>
<span class="p">}</span>
</code></pre></div></div> <p>If any accessor definition in the property does not match up to a behavior requirement, it is an error.</p> <p>The shorthand for get-only computed properties is only allowed for computed properties that use no behaviors. Any property that uses behaviors with accessors must name all those accessors explicitly.</p> <p>If a property with behaviors declares an inline initializer, the initializer expression is captured as the implementation of a computed, get-only property which is bound to the behavior’s initializer requirement. If the behavior does not have a behavior requirement, then it is an error to use an inline initializer expression. Conversely, it is an error not to provide an initializer expression to a behavior that requires one.</p> <p>Properties cannot be declared using behaviors inside protocols.</p> <p>Under this proposal, even if a property with a behavior has an initial value expression, the type is always required to be explicitly declared. Behaviors also do not allow for out-of-line initialization of properties. Both of these restrictions can be lifted by future extensions; see the <strong>Future directions</strong> section below.</p> <h2 id="impact-on-existing-code"> <a href="#impact-on-existing-code" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Impact on existing code </h2> <p>By itself, this is an additive feature that doesn’t impact existing code. However, with some of the future directions suggested, it can potentially obsolete <code class="highlighter-rouge">lazy</code>, <code class="highlighter-rouge">willSet</code>/<code class="highlighter-rouge">didSet</code>, and <code class="highlighter-rouge">@NSCopying</code> as hardcoded language features. We could grandfather these in, but my preference would be to phase them out by migrating them to library-based property behavior implementations. (Removing them should be its own separate proposal, though.)</p> <h2 id="alternatives-considered"> <a href="#alternatives-considered" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Alternatives considered </h2> <h3 id="using-a-protocol-formal-or-not-instead-of-a-new-declaration"> <a href="#using-a-protocol-formal-or-not-instead-of-a-new-declaration" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Using a protocol (formal or not) instead of a new declaration </h3> <p>A previous iteration of this proposal used an informal instantiation protocol for property behaviors, desugaring a behavior into function calls, so that:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="p">[</span><span class="kd">lazy</span><span class="p">]</span> <span class="n">foo</span> <span class="o">=</span> <span class="mi">1738</span>
</code></pre></div></div> <p>would act as sugar for something like this:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="err">`</span><span class="n">foo</span><span class="o">.</span><span class="p">[</span><span class="kd">lazy</span><span class="p">]</span><span class="err">`</span> <span class="o">=</span> <span class="nf">lazy</span><span class="p">(</span><span class="nv">var</span><span class="p">:</span> <span class="kt">Int</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">initializer</span><span class="p">:</span> <span class="p">{</span> <span class="mi">1738</span> <span class="p">})</span>
<span class="k">var</span> <span class="nv">foo</span><span class="p">:</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="k">get</span> <span class="p">{</span>
    <span class="k">return</span> <span class="err">`</span><span class="n">foo</span><span class="o">.</span><span class="p">[</span><span class="kd">lazy</span><span class="p">]</span><span class="err">`</span><span class="p">[</span><span class="nv">varIn</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span>
                        <span class="nv">initializer</span><span class="p">:</span> <span class="p">{</span> <span class="mi">1738</span> <span class="p">}]</span>
  <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span>
    <span class="err">`</span><span class="n">foo</span><span class="o">.</span><span class="p">[</span><span class="kd">lazy</span><span class="p">]</span><span class="err">`</span><span class="p">[</span><span class="nv">varIn</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span>
                 <span class="nv">initializer</span><span class="p">:</span> <span class="p">{</span> <span class="mi">1738</span> <span class="p">}]</span> <span class="o">=</span> <span class="n">newValue</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>There are a few disadvantages to this approach:</p> <ul> <li>Behaviors would pollute the namespace, potentially with multiple global functions and/or types.</li> <li>In practice, it would require every behavior to be implemented using a new (usually generic) type, which introduces runtime overhead for the type’s metadata structures.</li> <li>The property behavior logic ends up less clear, being encoded in unspecialized language constructs.</li> <li>Determining the capabilities of a behavior relied on function overload resolution, which can be fiddly, and would require a lot of special case diagnostic work to get good, property-oriented error messages out of.</li> <li>Without severely complicating the informal protocol, it would be difficult to support eager vs. deferred initializers, or allow mutating access to <code class="highlighter-rouge">self</code> concurrently with the property’s own storage without violating <code class="highlighter-rouge">inout</code> aliasing rules. The code generation for standalone behavior decls can hide this complexity.</li> </ul> <p>Making property behaviors a distinct declaration undeniably increases the language size, but the demand for something like behaviors is clearly there. In return for a new declaration, we get better namespacing, more efficient code generation, clearer, more descriptive code for their implementation, and more expressive power with better diagnostics. I argue that the complexity can pay for itself, today by eliminating several special-case language features, and potentially in the future by generalizing to other kinds of behaviors (or being subsumed by an all-encompassing macro system). For instance, a future <code class="highlighter-rouge">func behavior</code> could conceivably provide Python decorator-like behavior for transforming function bodies.</p> <h3 id="template-style-behavior-declaration-syntax"> <a href="#template-style-behavior-declaration-syntax" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> “Template”-style behavior declaration syntax </h3> <p>John McCall proposed a “template”-like syntax for property behaviors, used in a previous revision of this proposal:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">behavior</span> <span class="kd">var</span> <span class="p">[</span><span class="kd">lazy</span><span class="p">]</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">Value</span> <span class="o">=</span> <span class="n">initialValue</span> <span class="p">{</span>
  <span class="o">...</span>
<span class="p">}</span>
</code></pre></div></div> <p>It’s appealing from a declaration-follows-use standpoint, and provides convenient places to slot in name, type, and initial value bindings. However, this kind of syntax is unprecedented in Swift, and in initial review, was not popular.</p> <h3 id="declaration-syntax-for-properties-using-behaviors"> <a href="#declaration-syntax-for-properties-using-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Declaration syntax for properties using behaviors </h3> <p>Alternatives to the proposed <code class="highlighter-rouge">var [behavior] propertyName</code> syntax include:</p> <ul> <li>A different set of brackets, <code class="highlighter-rouge">var (behavior) propertyName</code> or <code class="highlighter-rouge">var {behavior} propertyName</code>. Parens have the problem of being ambiguous with a tuple <code class="highlighter-rouge">var</code> declaration, requiring lookahead to resolve. Square brackets also work better with other declarations behaviors could be extended to apply to in the future, such as subscripts or functions</li> <li>An attribute, such as <code class="highlighter-rouge">@behavior(lazy)</code> or <code class="highlighter-rouge">behavior(lazy) var</code>. This is the most conservative answer, but is clunky.</li> <li>Use the behavior function name directly as an attribute, so that e.g. <code class="highlighter-rouge">@lazy</code> works.</li> <li>Use a new keyword, as in <code class="highlighter-rouge">var x: T by behavior</code>.</li> <li>Something on the right side of the colon, such as <code class="highlighter-rouge">var x: lazy(T)</code>. To me this reads like <code class="highlighter-rouge">lazy(T)</code> is a type of some kind, which it really isn’t.</li> </ul> <h2 id="future-directions"> <a href="#future-directions" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Future directions </h2> <p>The functionality proposed here is quite broad, so to attempt to minimize the review burden of the initial proposal, I’ve factored out several aspects for separate consideration:</p> <h3 id="behaviors-for-immutable-let-properties"> <a href="#behaviors-for-immutable-let-properties" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Behaviors for immutable <code class="highlighter-rouge">let</code> properties </h3> <p>Since we don’t have an effects system (yet?), <code class="highlighter-rouge">let</code> behavior implementations have the potential to invalidate the immutability assumptions expected of <code class="highlighter-rouge">let</code> properties, and it would be the programmer’s responsibility to maintain them. We don’t support computed <code class="highlighter-rouge">let</code>s for the same reason, so I suggest leaving <code class="highlighter-rouge">let</code>s out of property behaviors for now. <code class="highlighter-rouge">let behavior</code>s could be added in the future when we have a comprehensive design for immutable computed properties and/or functions.</p> <h3 id="type-inference-of-properties-with-behaviors"> <a href="#type-inference-of-properties-with-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Type inference of properties with behaviors </h3> <p>There are subtle issues with inferring the type of a property using a behavior when the behavior introduces constraints on the property type. If you have something like this:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="nv">uint16only</span><span class="p">:</span> <span class="kt">UInt16</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">uint16only</span><span class="p">]</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1738</span>
</code></pre></div></div> <p>there are two, and possibly more, ways to define what happens:</p> <ul> <li>We type-check the initializer expression in isolation <em>before</em> resolving behaviors. In this case, <code class="highlighter-rouge">1738</code> would type-check by defaulting to <code class="highlighter-rouge">Int</code>, and then we’d raise an error instantiating the <code class="highlighter-rouge">uint16only</code> behavior, which requires a property to have type <code class="highlighter-rouge">UInt16</code>.</li> <li>We apply the behaviors <em>before</em> type-checking the initializer expression, introducing generic constraints on the contextual type of the initializer. In this case, applying the <code class="highlighter-rouge">uint16only</code> behavior would constrain the contextual type of the initializer to <code class="highlighter-rouge">UInt16</code>, and we’d successfully type-check the literal as a <code class="highlighter-rouge">UInt16</code>.</li> </ul> <p>There are merits and downsides to both approaches. To allow these issues to be given proper consideration, I’m subsetting them out by proposing to first require that properties with behaviors always declare an explicit type.</p> <h3 id="composing-behaviors"> <a href="#composing-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Composing behaviors </h3> <p>It is useful to be able to compose behaviors, for instance, to have a lazy property with observers that’s also synchronized. Relatedly, it is useful for subclasses to be able to <code class="highlighter-rouge">override</code> their inherited properties by applying behaviors over the base class implementation, as can be done with <code class="highlighter-rouge">didSet</code> and <code class="highlighter-rouge">willSet</code> today. Linear composition can be supported by allowing behaviors to stack, each referring to the underlying property beneath it by <code class="highlighter-rouge">super</code> or some other magic binding. However, this form of composition can be treacherous, since it allows for “incorrect” compositions of behaviors. One of <code class="highlighter-rouge">lazy • synchronized</code> or <code class="highlighter-rouge">synchronized • lazy</code> is going to do the wrong thing. This possibility can be handled somewhat by allowing certain compositions to be open-coded; John McCall has suggested that every composition ought to be directly implemented as an entirely distinct behavior. That of course has an obvious exponential explosion problem; it’s infeasible to anticipate and hand-code every useful combination of behaviors. These issues deserve careful separate consideration, so I’m leaving behavior composition out of this initial proposal.</p> <h3 id="deferred-evaluation-of-initialization-expressions"> <a href="#deferred-evaluation-of-initialization-expressions" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Deferred evaluation of initialization expressions </h3> <p>This proposal does not suggest changing the allowed operations inside initialization expressions; in particular, an initialization of an instance property may not refer to <code class="highlighter-rouge">self</code> or other instance properties or methods, due to the potential for the expression to execute before the value is fully initialized:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">Foo</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">a</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">var</span> <span class="nv">b</span> <span class="o">=</span> <span class="n">a</span> <span class="c1">// Not allowed</span>
  <span class="k">var</span> <span class="nv">c</span> <span class="o">=</span> <span class="nf">foo</span><span class="p">()</span> <span class="c1">// Not allowed</span>

  <span class="kd">func</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>This is inconvenient for behaviors like <code class="highlighter-rouge">lazy</code> that only ever evaluate the initial value expression after the true initialization phase has completed, and where it’s desirable to reference <code class="highlighter-rouge">self</code> to lazily initialize. Behaviors could be extended to annotate the initializer as “deferred”, which would allow the initializer expression to refer to <code class="highlighter-rouge">self</code>, while preventing the initializer expression from being evaluated at initialization time. (If we consider behaviors to be essentially always fragile, this could be inferred from the behavior implementation.)</p> <h3 id="out-of-line-initialization-with-behaviors"> <a href="#out-of-line-initialization-with-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Out-of-line initialization with behaviors </h3> <p>This proposal also does not allow for behaviors that support out-of-line initialization, as in:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Out-of-line local variable initialization</span>
  <span class="kd">var</span> <span class="p">[</span><span class="n">behavior</span><span class="p">]</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span>
  <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">Foo</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="p">[</span><span class="n">behavior</span><span class="p">]</span> <span class="nv">y</span><span class="p">:</span> <span class="kt">Int</span>

  <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Out-of-line instance property initialization</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>This is a fairly serious limitation for instance properties. There are a few potential approaches we can take. One is to allow a behavior’s <code class="highlighter-rouge">init</code> logic to take an out-of-line initialization as a parameter, either directly or by having a different constraint on the initializer requirement that <em>only</em> allows it to be referred to from <code class="highlighter-rouge">init</code> (the opposite of “deferred”). It can also be supported indirectly by linear behavior composition, if the default root <code class="highlighter-rouge">super</code> behavior for a stack of properties defaults to a plain old stored property, which can then follow normal initialization rules. This is similar to how <code class="highlighter-rouge">didSet</code>/<code class="highlighter-rouge">willSet</code> behave today. However, this would not allow behaviors to change the initialization behavior in any way.</p> <h3 id="binding-the-name-of-a-property-using-the-behavior"> <a href="#binding-the-name-of-a-property-using-the-behavior" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Binding the name of a property using the behavior </h3> <p>There are a number of clever things you can do with the name of a property if it can be referenced as a string, such as using it to look up a value in a map, to log, or to serialize. We could conceivably support a <code class="highlighter-rouge">name</code> requirement declaration:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">behavior</span> <span class="n">echo</span><span class="o">&lt;</span><span class="kt">Value</span><span class="p">:</span> <span class="kt">StringLiteralConvertible</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>

  <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">name</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="p">[</span><span class="n">echo</span><span class="p">]</span> <span class="nv">echo</span><span class="p">:</span> <span class="kt">String</span>
<span class="nf">print</span><span class="p">(</span><span class="n">echo</span><span class="p">)</span> <span class="c1">// =&gt; echo</span>
</code></pre></div></div> <h3 id="overloading-behaviors"> <a href="#overloading-behaviors" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Overloading behaviors </h3> <p>It may be useful for behaviors to be overloadable, for instance to give a different implementation to computed and stored variants of a concept:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// A behavior for stored properties...</span>
<span class="k">var</span> <span class="nv">behavior</span> <span class="n">foo</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="k">var</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Value</span> <span class="o">=</span> <span class="n">initialValue</span>
  <span class="k">get</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Same behavior for computed properties...</span>
<span class="k">var</span> <span class="nv">behavior</span> <span class="n">foo</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">Value</span> <span class="p">{</span>
  <span class="n">initialValue</span>

  <span class="n">accessor</span> <span class="nf">get</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Value</span>
  <span class="n">accessor</span> <span class="nf">set</span><span class="p">(</span><span class="nv">newValue</span><span class="p">:</span> <span class="kt">Value</span><span class="p">)</span>

  <span class="k">get</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
  <span class="k">set</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>We could resolve overloads by accessors, type constraints on <code class="highlighter-rouge">Value</code>, and/or initializer requirements. However, determining what this overload signature should be, and also the exciting interactions with type inference from initializer expressions, should be a separate discussion.</p> <h3 id="accessing-out-of-band-behavior-members"> <a href="#accessing-out-of-band-behavior-members" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Accessing “out-of-band” behavior members </h3> <p>It is useful to add out-of-band operations to a property that aren’t normal members of its formal type, for instance, to <code class="highlighter-rouge">clear</code> a lazy property to be recomputed later, or to reset a property to an implementation-defined default value. This is useful, but it complicates the design of the feature. Aside from the obvious surface-level concerns of syntax for accessing these members, this also exposes behaviors as interface rather than purely an implementation detail, meaning their interaction with resilience, protocols, class inheritance, and other abstractions needs to be designed. It’s also a fair question whether out-of- band members should be tied to behaviors at all–it could be useful to design out-of-band members as an independent feature independent with behaviors.</p> </div> </div> </div> </div> </body> </html>
